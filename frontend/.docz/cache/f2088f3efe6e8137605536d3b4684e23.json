{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx","mtime":1548345115595},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n/* eslint-disable camelcase,import/no-extraneous-dependencies,jsx-a11y/no-noninteractive-element-interactions */\n\n\nimport { event as d3_event, select as d3_select } from 'd3-selection';\nimport { axisBottom as d3_axis_bottom, axisLeft as d3_axis_left } from 'd3-axis';\nimport { scaleLinear as d3_scale_linear } from 'd3-scale';\nimport { extent as d3_extent } from 'd3-array';\nimport abbreviateNumber from 'utils/abbreviateNumber';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Responsive from 'react-components/shared/responsive.hoc';\nimport DropdownTabSwitcher from 'react-components/profiles/dropdown-tab-switcher/dropdown-tab-switcher.component';\nimport 'd3-transition';\nimport './scatterplot.scss';\n\nvar Scatterplot =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Scatterplot, _Component);\n\n  function Scatterplot(props) {\n    var _this;\n\n    _classCallCheck(this, Scatterplot);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Scatterplot).call(this, props));\n    _this.margins = {\n      top: 20,\n      right: 13,\n      bottom: 30,\n      left: 29\n    };\n    _this.state = {\n      selectedTabIndex: props.xDimensionSelectedIndex || 0\n    };\n    _this.handleSwitcherIndexChange = _this.handleSwitcherIndexChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Scatterplot, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.build();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var shouldRebuild = prevProps.year !== this.props.year || prevProps.width !== this.props.width;\n\n      if (shouldRebuild) {\n        this.build();\n      }\n    }\n  }, {\n    key: \"build\",\n    value: function build() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          data = _this$props.data,\n          showTooltipCallback = _this$props.showTooltipCallback,\n          hideTooltipCallback = _this$props.hideTooltipCallback,\n          testId = _this$props.testId;\n      var parentWidth = this.props.width;\n      var width = parentWidth - this.margins.left - this.margins.right;\n      var height = 377 - this.margins.top - this.margins.bottom;\n      var allYValues = data.map(function (item) {\n        return item.y;\n      });\n      var allXValues = data.map(function (item) {\n        return item.x[_this2.state.selectedTabIndex];\n      });\n      this.x = d3_scale_linear().range([0, width]).domain(d3_extent([0].concat(_toConsumableArray(allXValues))));\n      this.y = d3_scale_linear().range([height, 0]).domain(d3_extent([0].concat(_toConsumableArray(allYValues))));\n      this.xAxis = d3_axis_bottom(this.x).ticks(8).tickSize(-height, 0).tickPadding(9).tickFormat(function (value, i) {\n        if (i === 0) {\n          return null;\n        }\n\n        return abbreviateNumber(value, 3);\n      });\n      this.yAxis = d3_axis_left(this.y).ticks(7).tickSize(-width, 0).tickPadding(9).tickFormat(function (value) {\n        return abbreviateNumber(value, 3);\n      });\n      this.svgElement.innerHTML = '';\n      this.svg = d3_select(this.svgElement).attr('width', parentWidth).attr('height', height + this.margins.top + this.margins.bottom).append('g').attr('transform', \"translate(\".concat(this.margins.left, \",\").concat(this.margins.top, \")\"));\n      this.svg.append('g').attr('class', 'axis axis--x').attr('transform', \"translate(0,\".concat(height, \")\")).call(this.xAxis);\n      this.svg.append('g').attr('class', 'axis axis-line').attr('transform', \"translate(0,\".concat(height, \")\")).call(d3_axis_bottom(this.x).ticks(0).tickSizeOuter(0));\n      this.svg.append('g').attr('class', 'axis axis--y').call(this.yAxis);\n      this.svg.append('g').attr('class', 'axis axis-line').call(d3_axis_left(this.y).ticks(0).tickSizeOuter(0));\n      this.circles = this.svg.selectAll('circle').data(this._getFormattedData(this.state.selectedTabIndex)).enter().append('circle').attr('class', function (d) {\n        return d.x === null ? \"\".concat(_this2._getCircleClass(d), \" -hidden\") : _this2._getCircleClass(d);\n      }).attr('data-test', function (d) {\n        return d.isCurrent ? \"\".concat(testId, \"-circle-current\") : \"\".concat(testId, \"-circle\");\n      }).attr('r', 5).attr('cx', function (d) {\n        return _this2.x(d.x);\n      }).attr('cy', function (d) {\n        return _this2.y(d.y);\n      });\n\n      if (showTooltipCallback !== undefined) {\n        this.circles.on('mousemove', function (d) {\n          var selectedSwitcher = _this2.props.xDimension[_this2.state.selectedTabIndex];\n          showTooltipCallback(d, selectedSwitcher, d3_event.clientX + 10, d3_event.clientY + window.scrollY + 10);\n        }).on('mouseout', function () {\n          hideTooltipCallback();\n        });\n      }\n    }\n  }, {\n    key: \"handleSwitcherIndexChange\",\n    value: function handleSwitcherIndexChange(selectedTabIndex) {\n      var _this3 = this;\n\n      this.setState({\n        selectedTabIndex: selectedTabIndex\n      });\n\n      var newData = this._getFormattedData(selectedTabIndex);\n\n      var allXValues = newData.map(function (item) {\n        return item.x;\n      });\n      var x = d3_scale_linear().range([0, this.props.width - this.margins.left - this.margins.right]).domain(d3_extent([0].concat(_toConsumableArray(allXValues))));\n      this.xAxis.scale(x);\n      this.circles.data(newData).transition().duration(700).attr('cx', function (d) {\n        return x(d.x);\n      }).attr('class', function (d) {\n        return d.x === null ? \"\".concat(_this3._getCircleClass(d), \" -hidden\") : _this3._getCircleClass(d);\n      });\n      this.svg.select('.axis--x').transition().duration(500).call(this.xAxis);\n    }\n  }, {\n    key: \"_getFormattedData\",\n    value: function _getFormattedData(i) {\n      var _this$props2 = this.props,\n          data = _this$props2.data,\n          node = _this$props2.node;\n\n      var currentComesLast = function currentComesLast(a) {\n        return a.isCurrent ? 1 : -1;\n      };\n\n      return data.map(function (item) {\n        return {\n          nodeId: item.id,\n          name: item.name,\n          isCurrent: item.name.toUpperCase() === (node.name && node.name.toUpperCase()),\n          y: item.y,\n          x: item.x[i]\n        };\n      }).sort(currentComesLast);\n    }\n  }, {\n    key: \"_getCircleClass\",\n    value: function _getCircleClass(d) {\n      return d.isCurrent ? 'dot current' : 'dot';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props3 = this.props,\n          title = _this$props3.title,\n          xDimension = _this$props3.xDimension,\n          testId = _this$props3.testId;\n      var tabs = xDimension.filter(function (x, i) {\n        return i < 3;\n      });\n\n      var itemTabRenderer = function itemTabRenderer(_, index) {\n        var elem = tabs[index];\n        return React.createElement(\"span\", {\n          \"data-unit\": elem.unit !== null ? elem.unit : null\n        }, elem.name);\n      };\n\n      return React.createElement(\"div\", {\n        className: \"c-scatterplot\"\n      }, React.createElement(DropdownTabSwitcher, {\n        title: title,\n        testId: \"\".concat(testId, \"-switch\"),\n        items: tabs.map(function (e) {\n          return e.name;\n        }),\n        itemTabRenderer: itemTabRenderer,\n        onSelectedIndexChange: this.handleSwitcherIndexChange\n      }), React.createElement(\"div\", {\n        className: \"js-companies-exporting-y-axis axis-legend\"\n      }), React.createElement(\"div\", {\n        className: \"js-companies-exporting\"\n      }, React.createElement(\"svg\", {\n        ref: function ref(el) {\n          _this4.svgElement = el;\n        }\n      })));\n    }\n  }]);\n\n  return Scatterplot;\n}(Component);\n\nScatterplot.propTypes = {\n  testId: PropTypes.string,\n  title: PropTypes.any,\n  data: PropTypes.array,\n  node: PropTypes.object,\n  xDimension: PropTypes.array,\n  xDimensionSelectedIndex: PropTypes.number,\n  year: PropTypes.number,\n  width: PropTypes.number,\n  showTooltipCallback: PropTypes.func,\n  hideTooltipCallback: PropTypes.func\n};\n\nvar _default = Responsive()(Scatterplot);\n\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_typeof, \"_typeof\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_toConsumableArray, \"_toConsumableArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_nonIterableSpread, \"_nonIterableSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_iterableToArray, \"_iterableToArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_arrayWithoutHoles, \"_arrayWithoutHoles\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_defineProperties, \"_defineProperties\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_getPrototypeOf, \"_getPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_setPrototypeOf, \"_setPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_assertThisInitialized, \"_assertThisInitialized\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(Scatterplot, \"Scatterplot\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/scatterplot/scatterplot.component.jsx"],"names":["event","select","axisBottom","axisLeft","scaleLinear","extent","Scatterplot","Component","top","right","bottom","left","selectedTabIndex","props","prevProps","shouldRebuild","data","showTooltipCallback","hideTooltipCallback","testId","parentWidth","width","height","allYValues","item","allXValues","d3_scale_linear","d3_extent","i","abbreviateNumber","d3_select","d3_axis_bottom","d3_axis_left","d","selectedSwitcher","d3_event","window","newData","x","node","currentComesLast","a","nodeId","name","isCurrent","y","title","xDimension","tabs","itemTabRenderer","elem","e","handleSwitcherIndexChange","PropTypes","xDimensionSelectedIndex","year","func","Responsive"],"mappings":"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","sourcesContent":["/* eslint-disable camelcase,import/no-extraneous-dependencies,jsx-a11y/no-noninteractive-element-interactions */\nimport { event as d3_event, select as d3_select } from 'd3-selection';\nimport { axisBottom as d3_axis_bottom, axisLeft as d3_axis_left } from 'd3-axis';\nimport { scaleLinear as d3_scale_linear } from 'd3-scale';\nimport { extent as d3_extent } from 'd3-array';\n\nimport abbreviateNumber from 'utils/abbreviateNumber';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Responsive from 'react-components/shared/responsive.hoc';\nimport DropdownTabSwitcher from 'react-components/profiles/dropdown-tab-switcher/dropdown-tab-switcher.component';\n\nimport 'd3-transition';\nimport './scatterplot.scss';\n\nclass Scatterplot extends Component {\n  constructor(props) {\n    super(props);\n\n    this.margins = {\n      top: 20,\n      right: 13,\n      bottom: 30,\n      left: 29\n    };\n    this.state = {\n      selectedTabIndex: props.xDimensionSelectedIndex || 0\n    };\n\n    this.handleSwitcherIndexChange = this.handleSwitcherIndexChange.bind(this);\n  }\n\n  componentDidMount() {\n    this.build();\n  }\n\n  componentDidUpdate(prevProps) {\n    const shouldRebuild =\n      prevProps.year !== this.props.year || prevProps.width !== this.props.width;\n\n    if (shouldRebuild) {\n      this.build();\n    }\n  }\n\n  build() {\n    const { data, showTooltipCallback, hideTooltipCallback, testId } = this.props;\n    const parentWidth = this.props.width;\n\n    const width = parentWidth - this.margins.left - this.margins.right;\n    const height = 377 - this.margins.top - this.margins.bottom;\n    const allYValues = data.map(item => item.y);\n    const allXValues = data.map(item => item.x[this.state.selectedTabIndex]);\n\n    this.x = d3_scale_linear()\n      .range([0, width])\n      .domain(d3_extent([0, ...allXValues]));\n\n    this.y = d3_scale_linear()\n      .range([height, 0])\n      .domain(d3_extent([0, ...allYValues]));\n\n    this.xAxis = d3_axis_bottom(this.x)\n      .ticks(8)\n      .tickSize(-height, 0)\n      .tickPadding(9)\n      .tickFormat((value, i) => {\n        if (i === 0) {\n          return null;\n        }\n\n        return abbreviateNumber(value, 3);\n      });\n\n    this.yAxis = d3_axis_left(this.y)\n      .ticks(7)\n      .tickSize(-width, 0)\n      .tickPadding(9)\n      .tickFormat(value => abbreviateNumber(value, 3));\n\n    this.svgElement.innerHTML = '';\n\n    this.svg = d3_select(this.svgElement)\n      .attr('width', parentWidth)\n      .attr('height', height + this.margins.top + this.margins.bottom)\n      .append('g')\n      .attr('transform', `translate(${this.margins.left},${this.margins.top})`);\n\n    this.svg\n      .append('g')\n      .attr('class', 'axis axis--x')\n      .attr('transform', `translate(0,${height})`)\n      .call(this.xAxis);\n\n    this.svg\n      .append('g')\n      .attr('class', 'axis axis-line')\n      .attr('transform', `translate(0,${height})`)\n      .call(\n        d3_axis_bottom(this.x)\n          .ticks(0)\n          .tickSizeOuter(0)\n      );\n\n    this.svg\n      .append('g')\n      .attr('class', 'axis axis--y')\n      .call(this.yAxis);\n\n    this.svg\n      .append('g')\n      .attr('class', 'axis axis-line')\n      .call(\n        d3_axis_left(this.y)\n          .ticks(0)\n          .tickSizeOuter(0)\n      );\n\n    this.circles = this.svg\n      .selectAll('circle')\n      .data(this._getFormattedData(this.state.selectedTabIndex))\n      .enter()\n      .append('circle')\n      .attr('class', d =>\n        d.x === null ? `${this._getCircleClass(d)} -hidden` : this._getCircleClass(d)\n      )\n      .attr('data-test', d => (d.isCurrent ? `${testId}-circle-current` : `${testId}-circle`))\n      .attr('r', 5)\n      .attr('cx', d => this.x(d.x))\n      .attr('cy', d => this.y(d.y));\n\n    if (showTooltipCallback !== undefined) {\n      this.circles\n        .on('mousemove', d => {\n          const selectedSwitcher = this.props.xDimension[this.state.selectedTabIndex];\n          showTooltipCallback(\n            d,\n            selectedSwitcher,\n            d3_event.clientX + 10,\n            d3_event.clientY + window.scrollY + 10\n          );\n        })\n        .on('mouseout', () => {\n          hideTooltipCallback();\n        });\n    }\n  }\n\n  handleSwitcherIndexChange(selectedTabIndex) {\n    this.setState({ selectedTabIndex });\n\n    const newData = this._getFormattedData(selectedTabIndex);\n    const allXValues = newData.map(item => item.x);\n    const x = d3_scale_linear()\n      .range([0, this.props.width - this.margins.left - this.margins.right])\n      .domain(d3_extent([0, ...allXValues]));\n    this.xAxis.scale(x);\n\n    this.circles\n      .data(newData)\n      .transition()\n      .duration(700)\n      .attr('cx', d => x(d.x))\n      .attr('class', d =>\n        d.x === null ? `${this._getCircleClass(d)} -hidden` : this._getCircleClass(d)\n      );\n\n    this.svg\n      .select('.axis--x')\n      .transition()\n      .duration(500)\n      .call(this.xAxis);\n  }\n\n  _getFormattedData(i) {\n    const { data, node } = this.props;\n    const currentComesLast = a => (a.isCurrent ? 1 : -1);\n\n    return data\n      .map(item => ({\n        nodeId: item.id,\n        name: item.name,\n        isCurrent: item.name.toUpperCase() === (node.name && node.name.toUpperCase()),\n        y: item.y,\n        x: item.x[i]\n      }))\n      .sort(currentComesLast);\n  }\n\n  _getCircleClass(d) {\n    return d.isCurrent ? 'dot current' : 'dot';\n  }\n\n  render() {\n    const { title, xDimension, testId } = this.props;\n    const tabs = xDimension.filter((x, i) => i < 3);\n    const itemTabRenderer = (_, index) => {\n      const elem = tabs[index];\n      return <span data-unit={elem.unit !== null ? elem.unit : null}>{elem.name}</span>;\n    };\n\n    return (\n      <div className=\"c-scatterplot\">\n        <DropdownTabSwitcher\n          title={title}\n          testId={`${testId}-switch`}\n          items={tabs.map(e => e.name)}\n          itemTabRenderer={itemTabRenderer}\n          onSelectedIndexChange={this.handleSwitcherIndexChange}\n        />\n        <div className=\"js-companies-exporting-y-axis axis-legend\" />\n        <div className=\"js-companies-exporting\">\n          <svg\n            ref={el => {\n              this.svgElement = el;\n            }}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nScatterplot.propTypes = {\n  testId: PropTypes.string,\n  title: PropTypes.any,\n  data: PropTypes.array,\n  node: PropTypes.object,\n  xDimension: PropTypes.array,\n  xDimensionSelectedIndex: PropTypes.number,\n  year: PropTypes.number,\n  width: PropTypes.number,\n  showTooltipCallback: PropTypes.func,\n  hideTooltipCallback: PropTypes.func\n};\n\nexport default Responsive()(Scatterplot);\n"]}]}