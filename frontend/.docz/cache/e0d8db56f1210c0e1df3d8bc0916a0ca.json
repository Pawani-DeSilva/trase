{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js","mtime":1548424841369},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nimport { getURLFromParams } from 'utils/getURLFromParams';\nimport qs from 'qs';\nimport sortBy from 'lodash/sortBy';\nexport var WIDGETS__INIT_ENDPOINT = 'WIDGETS__INIT_ENDPOINT';\nexport var WIDGETS__SET_ENDPOINT_DATA = 'WIDGETS__SET_ENDPOINT_DATA';\nexport var WIDGETS__SET_ENDPOINT_ERROR = 'WIDGETS__SET_ENDPOINT_ERROR';\nexport function prepareWidget(endpoints, _ref) {\n  var endpoint = _ref.endpoint,\n      params = _ref.params,\n      raw = _ref.raw;\n  var key = sortBy(Object.entries(params || {\n    noParams: true\n  }), function (entry) {\n    return entry[0];\n  }).map(function (_ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        name = _ref3[0],\n        value = _ref3[1];\n\n    return \"\".concat(name).concat(value);\n  }).join('_');\n  var url = null;\n  var cacheMiss = typeof endpoints[endpoint] === 'undefined' || endpoints[endpoint].key !== key;\n\n  if (cacheMiss) {\n    if (raw) {\n      url = endpoint;\n\n      if (params) {\n        var search = qs.stringify(params, {\n          encodeValuesOnly: true\n        });\n        url = endpoint.includes('?') ? \"\".concat(endpoint, \"&\").concat(search) : \"\".concat(endpoint, \"?\").concat(search);\n      }\n    } else {\n      url = getURLFromParams(endpoint, params);\n    }\n  }\n\n  return {\n    key: key,\n    cacheMiss: cacheMiss,\n    url: url\n  };\n}\nexport function getWidgetState(query, endpoints) {\n  return query.reduce(function (acc, endpoint) {\n    var current = endpoints[endpoint];\n    if (!current) return {\n      loading: true\n    };\n    return {\n      data: _objectSpread({}, acc.data, _defineProperty({}, endpoint, current.data || null)),\n      meta: _objectSpread({}, acc.meta, _defineProperty({}, endpoint, current.meta || null)),\n      loading: acc.loading || current.loading,\n      error: acc.error || current.error\n    };\n  }, {\n    data: {},\n    loading: false,\n    error: null\n  });\n}\nexport var getWidgetData = function getWidgetData(endpoint, params, raw) {\n  return function (dispatch, getState) {\n    var endpoints = getState().widgets.endpoints;\n\n    var _prepareWidget = prepareWidget(endpoints, {\n      endpoint: endpoint,\n      params: params,\n      raw: raw\n    }),\n        cacheMiss = _prepareWidget.cacheMiss,\n        key = _prepareWidget.key,\n        url = _prepareWidget.url;\n\n    if (cacheMiss) {\n      dispatch({\n        type: WIDGETS__INIT_ENDPOINT,\n        payload: {\n          endpoint: endpoint,\n          key: key\n        }\n      });\n      fetch(url).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(function (res) {\n        return dispatch({\n          type: WIDGETS__SET_ENDPOINT_DATA,\n          payload: _objectSpread({}, res, {\n            endpoint: endpoint\n          })\n        });\n      }).catch(function (error) {\n        return dispatch({\n          type: WIDGETS__SET_ENDPOINT_ERROR,\n          payload: {\n            endpoint: endpoint,\n            error: error\n          }\n        });\n      });\n    }\n  };\n};\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_objectSpread, \"_objectSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(_defineProperty, \"_defineProperty\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(_slicedToArray, \"_slicedToArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(_nonIterableRest, \"_nonIterableRest\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(_iterableToArrayLimit, \"_iterableToArrayLimit\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(_arrayWithHoles, \"_arrayWithHoles\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(WIDGETS__INIT_ENDPOINT, \"WIDGETS__INIT_ENDPOINT\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(WIDGETS__SET_ENDPOINT_DATA, \"WIDGETS__SET_ENDPOINT_DATA\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(WIDGETS__SET_ENDPOINT_ERROR, \"WIDGETS__SET_ENDPOINT_ERROR\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(prepareWidget, \"prepareWidget\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(getWidgetState, \"getWidgetState\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  reactHotLoader.register(getWidgetData, \"getWidgetData\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/widgets/widgets.actions.js"],"names":["WIDGETS__INIT_ENDPOINT","WIDGETS__SET_ENDPOINT_DATA","WIDGETS__SET_ENDPOINT_ERROR","endpoint","params","raw","key","noParams","entry","name","value","url","cacheMiss","endpoints","search","encodeValuesOnly","getURLFromParams","current","loading","data","acc","meta","error","getWidgetData","getState","prepareWidget","dispatch","type","payload","fetch","res","Promise"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAAA,gBAAA,QAAA,wBAAA;AACA,OAAA,EAAA,MAAA,IAAA;AACA,OAAA,MAAA,MAAA,eAAA;AAEA,OAAO,IAAMA,sBAAsB,GAA5B,wBAAA;AACP,OAAO,IAAMC,0BAA0B,GAAhC,4BAAA;AACP,OAAO,IAAMC,2BAA2B,GAAjC,6BAAA;AAEP,OAAO,SAAA,aAAA,CAAA,SAAA,EAAA,IAAA,EAA6D;AAAA,MAAzBC,QAAyB,GAAA,IAAA,CAAzBA,QAAyB;AAAA,MAAfC,MAAe,GAAA,IAAA,CAAfA,MAAe;AAAA,MAAPC,GAAO,GAAA,IAAA,CAAPA,GAAO;AAClE,MAAMC,GAAG,GAAG,MAAM,CAAC,MAAM,CAAN,OAAA,CAAeF,MAAM,IAAI;AAAEG,IAAAA,QAAQ,EAAE;AAAZ,GAAzB,CAAD,EAA+C,UAAA,KAAA,EAAK;AAAA,WAAIC,KAAK,CAAT,CAAS,CAAT;AAA1D,GAAM,CAAN,CAAA,GAAA,CACL,UAAA,KAAA,EAAA;AAAA,QAAA,KAAA,GAAA,cAAA,CAAA,KAAA,EAAA,CAAA,CAAA;AAAA,QAAEC,IAAF,GAAA,KAAA,CAAA,CAAA,CAAA;AAAA,QAAQC,KAAR,GAAA,KAAA,CAAA,CAAA,CAAA;;AAAA,WAAA,GAAA,MAAA,CAAA,IAAA,EAAA,MAAA,CAAA,KAAA,CAAA;AADK,GAAA,EAAA,IAAA,CAAZ,GAAY,CAAZ;AAGA,MAAIC,GAAG,GAAP,IAAA;AACA,MAAMC,SAAS,GAAG,OAAOC,SAAS,CAAhB,QAAgB,CAAhB,KAAA,WAAA,IAA8CA,SAAS,CAATA,QAAS,CAATA,CAAAA,GAAAA,KAAhE,GAAA;;AAEA,MAAA,SAAA,EAAe;AACb,QAAA,GAAA,EAAS;AACPF,MAAAA,GAAG,GAAHA,QAAAA;;AACA,UAAA,MAAA,EAAY;AACV,YAAMG,MAAM,GAAG,EAAE,CAAF,SAAA,CAAA,MAAA,EAAqB;AAAEC,UAAAA,gBAAgB,EAAE;AAApB,SAArB,CAAf;AACAJ,QAAAA,GAAG,GAAGR,QAAQ,CAARA,QAAAA,CAAAA,GAAAA,IAAAA,GAAAA,MAAAA,CAAAA,QAAAA,EAAAA,GAAAA,EAAAA,MAAAA,CAAAA,MAAAA,CAAAA,GAAAA,GAAAA,MAAAA,CAAAA,QAAAA,EAAAA,GAAAA,EAAAA,MAAAA,CAANQ,MAAMR,CAANQ;AACD;AALH,KAAA,MAMO;AACLA,MAAAA,GAAG,GAAGK,gBAAgB,CAAA,QAAA,EAAtBL,MAAsB,CAAtBA;AACD;AACF;;AAED,SAAO;AAAEL,IAAAA,GAAG,EAAL,GAAA;AAAOM,IAAAA,SAAS,EAAhB,SAAA;AAAkBD,IAAAA,GAAG,EAAHA;AAAlB,GAAP;AACD;AAED,OAAO,SAAA,cAAA,CAAA,KAAA,EAAA,SAAA,EAA0C;AAC/C,SAAO,KAAK,CAAL,MAAA,CACL,UAAA,GAAA,EAAA,QAAA,EAAmB;AACjB,QAAMM,OAAO,GAAGJ,SAAS,CAAzB,QAAyB,CAAzB;AACA,QAAI,CAAJ,OAAA,EAAc,OAAO;AAAEK,MAAAA,OAAO,EAAE;AAAX,KAAP;AACd,WAAO;AACLC,MAAAA,IAAI,EAAA,aAAA,CAAA,EAAA,EACCC,GAAG,CADJ,IAAA,EAAA,eAAA,CAAA,EAAA,EAAA,QAAA,EAEUH,OAAO,CAAPA,IAAAA,IAHT,IACD,CAAA,CADC;AAKLI,MAAAA,IAAI,EAAA,aAAA,CAAA,EAAA,EACCD,GAAG,CADJ,IAAA,EAAA,eAAA,CAAA,EAAA,EAAA,QAAA,EAEUH,OAAO,CAAPA,IAAAA,IAPT,IAKD,CAAA,CALC;AASLC,MAAAA,OAAO,EAAEE,GAAG,CAAHA,OAAAA,IAAeH,OAAO,CAT1B,OAAA;AAULK,MAAAA,KAAK,EAAEF,GAAG,CAAHA,KAAAA,IAAaH,OAAO,CAACK;AAVvB,KAAP;AAJG,GAAA,EAiBL;AAAEH,IAAAA,IAAI,EAAN,EAAA;AAAYD,IAAAA,OAAO,EAAnB,KAAA;AAA4BI,IAAAA,KAAK,EAAE;AAAnC,GAjBK,CAAP;AAmBD;AAED,OAAO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAA,QAAA,EAAA,MAAA,EAAA,GAAA,EAAA;AAAA,SAA2B,UAAA,QAAA,EAAA,QAAA,EAAwB;AAAA,QACtEV,SADsE,GACxDW,QAAQ,GADgD,OACxDA,CADwD,SAAA;;AAAA,QAAA,cAAA,GAE9CC,aAAa,CAAA,SAAA,EAAY;AAAEtB,MAAAA,QAAQ,EAAV,QAAA;AAAYC,MAAAA,MAAM,EAAlB,MAAA;AAAoBC,MAAAA,GAAG,EAAHA;AAApB,KAAZ,CAFiC;AAAA,QAEtEO,SAFsE,GAAA,cAAA,CAAA,SAAA;AAAA,QAE3DN,GAF2D,GAAA,cAAA,CAAA,GAAA;AAAA,QAEtDK,GAFsD,GAAA,cAAA,CAAA,GAAA;;AAG9E,QAAA,SAAA,EAAe;AACbe,MAAAA,QAAQ,CAAC;AACPC,QAAAA,IAAI,EADG,sBAAA;AAEPC,QAAAA,OAAO,EAAE;AAAEzB,UAAAA,QAAQ,EAAV,QAAA;AAAYG,UAAAA,GAAG,EAAHA;AAAZ;AAFF,OAAD,CAARoB;AAKAG,MAAAA,KAAK,CAALA,GAAK,CAALA,CAAAA,IAAAA,CACQ,UAAA,GAAA,EAAG;AAAA,eAAKC,GAAG,CAAHA,EAAAA,GAASA,GAAG,CAAZA,IAASA,EAATA,GAAsBC,OAAO,CAAPA,MAAAA,CAA3B,GAA2BA,CAA3B;AADXF,OAAAA,EAAAA,IAAAA,CAEQ,UAAA,GAAA,EAAG;AAAA,eACPH,QAAQ,CAAC;AACPC,UAAAA,IAAI,EADG,0BAAA;AAEPC,UAAAA,OAAO,EAAA,aAAA,CAAA,EAAA,EAAA,GAAA,EAAA;AAAYzB,YAAAA,QAAQ,EAARA;AAAZ,WAAA;AAFA,SAAD,CADD;AAFX0B,OAAAA,EAAAA,KAAAA,CAQS,UAAA,KAAA,EAAK;AAAA,eACVH,QAAQ,CAAC;AACPC,UAAAA,IAAI,EADG,2BAAA;AAEPC,UAAAA,OAAO,EAAE;AAAEzB,YAAAA,QAAQ,EAAV,QAAA;AAAYmB,YAAAA,KAAK,EAALA;AAAZ;AAFF,SAAD,CADE;AARdO,OAAAA;AAcD;AAvB0B,GAAA;AAAtB,CAAA;;;;;;;;;;;;;;;;;;0BAhDM7B,sB;0BACAC,0B;0BACAC,2B;0BAEN,a;0BAsBA,c;0BAsBMqB,a","sourcesContent":["import { getURLFromParams } from 'utils/getURLFromParams';\nimport qs from 'qs';\nimport sortBy from 'lodash/sortBy';\n\nexport const WIDGETS__INIT_ENDPOINT = 'WIDGETS__INIT_ENDPOINT';\nexport const WIDGETS__SET_ENDPOINT_DATA = 'WIDGETS__SET_ENDPOINT_DATA';\nexport const WIDGETS__SET_ENDPOINT_ERROR = 'WIDGETS__SET_ENDPOINT_ERROR';\n\nexport function prepareWidget(endpoints, { endpoint, params, raw }) {\n  const key = sortBy(Object.entries(params || { noParams: true }), entry => entry[0])\n    .map(([name, value]) => `${name}${value}`)\n    .join('_');\n  let url = null;\n  const cacheMiss = typeof endpoints[endpoint] === 'undefined' || endpoints[endpoint].key !== key;\n\n  if (cacheMiss) {\n    if (raw) {\n      url = endpoint;\n      if (params) {\n        const search = qs.stringify(params, { encodeValuesOnly: true });\n        url = endpoint.includes('?') ? `${endpoint}&${search}` : `${endpoint}?${search}`;\n      }\n    } else {\n      url = getURLFromParams(endpoint, params);\n    }\n  }\n\n  return { key, cacheMiss, url };\n}\n\nexport function getWidgetState(query, endpoints) {\n  return query.reduce(\n    (acc, endpoint) => {\n      const current = endpoints[endpoint];\n      if (!current) return { loading: true };\n      return {\n        data: {\n          ...acc.data,\n          [endpoint]: current.data || null\n        },\n        meta: {\n          ...acc.meta,\n          [endpoint]: current.meta || null\n        },\n        loading: acc.loading || current.loading,\n        error: acc.error || current.error\n      };\n    },\n    { data: {}, loading: false, error: null }\n  );\n}\n\nexport const getWidgetData = (endpoint, params, raw) => (dispatch, getState) => {\n  const { endpoints } = getState().widgets;\n  const { cacheMiss, key, url } = prepareWidget(endpoints, { endpoint, params, raw });\n  if (cacheMiss) {\n    dispatch({\n      type: WIDGETS__INIT_ENDPOINT,\n      payload: { endpoint, key }\n    });\n\n    fetch(url)\n      .then(res => (res.ok ? res.json() : Promise.reject(res)))\n      .then(res =>\n        dispatch({\n          type: WIDGETS__SET_ENDPOINT_DATA,\n          payload: { ...res, endpoint }\n        })\n      )\n      .catch(error =>\n        dispatch({\n          type: WIDGETS__SET_ENDPOINT_ERROR,\n          payload: { endpoint, error }\n        })\n      );\n  }\n};\n"]}]}