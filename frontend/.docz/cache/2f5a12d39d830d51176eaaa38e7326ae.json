{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx","mtime":1548345115598},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport UnitsTooltip from 'react-components/shared/units-tooltip/units-tooltip.component';\nimport formatValue from 'utils/formatValue';\nimport { translateText } from 'utils/transifex';\nimport ChoroLegend from 'react-components/profiles/choro-legend.component';\nimport cx from 'classnames';\nimport Map from 'react-components/profiles/map.component';\n\nvar TopDestinationsMap =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(TopDestinationsMap, _React$PureComponent);\n\n  function TopDestinationsMap() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TopDestinationsMap);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TopDestinationsMap)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      tooltipConfig: null\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onMouseMove\", function (geography, x, y) {\n      var _this$props = _this.props,\n          year = _this$props.year,\n          includedYears = _this$props.includedYears,\n          lines = _this$props.lines,\n          nodeName = _this$props.nodeName,\n          activeTab = _this$props.activeTab;\n      var searchKey = activeTab ? 'geoid' : 'iso2';\n      var polygon = lines.find(function (c) {\n        return geography.properties[searchKey] === c.geo_id;\n      });\n\n      if (polygon) {\n        var text = \"\".concat(polygon.name.toUpperCase(), \" > \").concat(nodeName);\n        var title = 'Trade Volume';\n        var unit = 't';\n        var yearIndex = includedYears.findIndex(function (ye) {\n          return ye === year;\n        });\n        var currentYear = polygon.values[yearIndex];\n        var value = currentYear ? formatValue(currentYear, 'Trade volume') : 'Unknown';\n        var tooltipConfig = {\n          x: x,\n          y: y,\n          text: text,\n          items: [{\n            title: title,\n            value: value,\n            unit: unit\n          }]\n        };\n\n        _this.setState(function () {\n          return {\n            tooltipConfig: tooltipConfig\n          };\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onMouseLeave\", function () {\n      _this.setState(function () {\n        return {\n          tooltipConfig: null\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getPolygonClassName\", function (geography) {\n      var _this$props2 = _this.props,\n          lines = _this$props2.lines,\n          activeTab = _this$props2.activeTab;\n      var searchKey = activeTab ? 'geoid' : 'iso2';\n      var polygon = lines.find(function (c) {\n        return geography.properties[searchKey] === c.geo_id;\n      });\n      var value = 'n-a';\n      if (polygon) value = typeof polygon.value9 !== 'undefined' ? polygon.value9 : 'n-a';\n      return \"-outline ch-\".concat(value);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getPolygonTestId\", function (geography, testId) {\n      var _this$props3 = _this.props,\n          lines = _this$props3.lines,\n          activeTab = _this$props3.activeTab;\n      var searchKey = activeTab ? 'geoid' : 'iso2';\n      var polygon = lines.find(function (c) {\n        return geography.properties[searchKey] === c.geo_id;\n      });\n\n      if (polygon) {\n        return \"\".concat(testId, \"-polygon-colored\");\n      }\n\n      return \"\".concat(testId, \"-polygon\");\n    });\n\n    return _this;\n  }\n\n  _createClass(TopDestinationsMap, [{\n    key: \"getTopoJsonRoot\",\n    value: function getTopoJsonRoot() {\n      var _this$props4 = this.props,\n          activeTab = _this$props4.activeTab,\n          countryName = _this$props4.countryName;\n\n      if (activeTab) {\n        return countryName && \"\".concat(countryName.toUpperCase(), \"_\").concat(activeTab.toUpperCase());\n      }\n\n      return 'world';\n    }\n  }, {\n    key: \"getTopoJsonLink\",\n    value: function getTopoJsonLink() {\n      var _this$props5 = this.props,\n          activeTab = _this$props5.activeTab,\n          countryName = _this$props5.countryName;\n\n      if (activeTab) {\n        return countryName && \"./vector_layers/\".concat(countryName.toUpperCase(), \"_\").concat(activeTab.toUpperCase(), \".topo.json\");\n      }\n\n      return './vector_layers/WORLD.topo.json';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props6 = this.props,\n          year = _this$props6.year,\n          printMode = _this$props6.printMode,\n          buckets = _this$props6.buckets,\n          verb = _this$props6.verb,\n          activeTab = _this$props6.activeTab,\n          height = _this$props6.height,\n          commodityName = _this$props6.commodityName,\n          testId = _this$props6.testId;\n      var tooltipConfig = this.state.tooltipConfig;\n      var width = activeTab ? 400 : '100%';\n      return React.createElement(React.Fragment, null, React.createElement(UnitsTooltip, _extends({\n        show: !!tooltipConfig\n      }, tooltipConfig)), React.createElement(\"div\", {\n        className: \"row align-right\",\n        \"data-test\": testId\n      }, React.createElement(\"div\", {\n        className: cx('column', 'small-12', {\n          'medium-6': printMode\n        })\n      }, React.createElement(ChoroLegend, {\n        testId: \"\".concat(testId, \"-legend\"),\n        title: [translateText(\"\".concat(commodityName, \" \").concat(verb, \" in \").concat(year)), translateText('(tonnes)')],\n        bucket: [buckets[0]].concat(_toConsumableArray(buckets))\n      })), React.createElement(\"div\", {\n        className: \"column small-12\"\n      }, React.createElement(\"div\", {\n        className: \"top-destinations-map-container\",\n        style: {\n          height: height,\n          width: width\n        }\n      }, React.createElement(Map, {\n        testId: \"\".concat(testId, \"-d3\"),\n        topoJSONPath: this.getTopoJsonLink(),\n        topoJSONRoot: this.getTopoJsonRoot(),\n        getPolygonTestId: this.getPolygonTestId,\n        getPolygonClassName: this.getPolygonClassName,\n        showTooltipCallback: this.onMouseMove,\n        hideTooltipCallback: this.onMouseLeave,\n        useRobinsonProjection: !activeTab\n      })))));\n    }\n  }]);\n\n  return TopDestinationsMap;\n}(React.PureComponent);\n\nTopDestinationsMap.propTypes = {\n  testId: PropTypes.string,\n  printMode: PropTypes.bool,\n  nodeName: PropTypes.string,\n  activeTab: PropTypes.string,\n  profileType: PropTypes.string,\n  countryName: PropTypes.string,\n  commodityName: PropTypes.string,\n  verb: PropTypes.string.isRequired,\n  lines: PropTypes.array.isRequired,\n  year: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  buckets: PropTypes.array.isRequired,\n  includedYears: PropTypes.array.isRequired\n};\nvar _default = TopDestinationsMap;\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_typeof, \"_typeof\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_toConsumableArray, \"_toConsumableArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_nonIterableSpread, \"_nonIterableSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_iterableToArray, \"_iterableToArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_arrayWithoutHoles, \"_arrayWithoutHoles\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_extends, \"_extends\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_defineProperties, \"_defineProperties\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_getPrototypeOf, \"_getPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_setPrototypeOf, \"_setPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_assertThisInitialized, \"_assertThisInitialized\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_defineProperty, \"_defineProperty\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(TopDestinationsMap, \"TopDestinationsMap\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profiles/top-destinations-map.component.jsx"],"names":["TopDestinationsMap","React","PureComponent","tooltipConfig","year","includedYears","lines","nodeName","activeTab","searchKey","polygon","geography","c","text","title","unit","yearIndex","ye","currentYear","value","formatValue","x","y","items","countryName","printMode","buckets","verb","height","commodityName","testId","width","cx","translateText","PropTypes","profileType","isRequired"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport UnitsTooltip from 'react-components/shared/units-tooltip/units-tooltip.component';\nimport formatValue from 'utils/formatValue';\nimport { translateText } from 'utils/transifex';\nimport ChoroLegend from 'react-components/profiles/choro-legend.component';\nimport cx from 'classnames';\nimport Map from 'react-components/profiles/map.component';\n\nclass TopDestinationsMap extends React.PureComponent {\n  state = { tooltipConfig: null };\n\n  onMouseMove = (geography, x, y) => {\n    const { year, includedYears, lines, nodeName, activeTab } = this.props;\n    const searchKey = activeTab ? 'geoid' : 'iso2';\n    const polygon = lines.find(c => geography.properties[searchKey] === c.geo_id);\n    if (polygon) {\n      const text = `${polygon.name.toUpperCase()} > ${nodeName}`;\n      const title = 'Trade Volume';\n      const unit = 't';\n      const yearIndex = includedYears.findIndex(ye => ye === year);\n      const currentYear = polygon.values[yearIndex];\n      const value = currentYear ? formatValue(currentYear, 'Trade volume') : 'Unknown';\n      const tooltipConfig = { x, y, text, items: [{ title, value, unit }] };\n      this.setState(() => ({ tooltipConfig }));\n    }\n  };\n\n  onMouseLeave = () => {\n    this.setState(() => ({ tooltipConfig: null }));\n  };\n\n  getPolygonClassName = geography => {\n    const { lines, activeTab } = this.props;\n    const searchKey = activeTab ? 'geoid' : 'iso2';\n    const polygon = lines.find(c => geography.properties[searchKey] === c.geo_id);\n    let value = 'n-a';\n    if (polygon) value = typeof polygon.value9 !== 'undefined' ? polygon.value9 : 'n-a';\n    return `-outline ch-${value}`;\n  };\n\n  getPolygonTestId = (geography, testId) => {\n    const { lines, activeTab } = this.props;\n    const searchKey = activeTab ? 'geoid' : 'iso2';\n    const polygon = lines.find(c => geography.properties[searchKey] === c.geo_id);\n    if (polygon) {\n      return `${testId}-polygon-colored`;\n    }\n    return `${testId}-polygon`;\n  };\n\n  getTopoJsonRoot() {\n    const { activeTab, countryName } = this.props;\n    if (activeTab) {\n      return countryName && `${countryName.toUpperCase()}_${activeTab.toUpperCase()}`;\n    }\n    return 'world';\n  }\n\n  getTopoJsonLink() {\n    const { activeTab, countryName } = this.props;\n    if (activeTab) {\n      return (\n        countryName &&\n        `./vector_layers/${countryName.toUpperCase()}_${activeTab.toUpperCase()}.topo.json`\n      );\n    }\n    return './vector_layers/WORLD.topo.json';\n  }\n\n  render() {\n    const { year, printMode, buckets, verb, activeTab, height, commodityName, testId } = this.props;\n    const { tooltipConfig } = this.state;\n    const width = activeTab ? 400 : '100%';\n\n    return (\n      <React.Fragment>\n        <UnitsTooltip show={!!tooltipConfig} {...tooltipConfig} />\n        <div className=\"row align-right\" data-test={testId}>\n          <div\n            className={cx('column', 'small-12', {\n              'medium-6': printMode\n            })}\n          >\n            <ChoroLegend\n              testId={`${testId}-legend`}\n              title={[\n                translateText(`${commodityName} ${verb} in ${year}`),\n                translateText('(tonnes)')\n              ]}\n              bucket={[buckets[0], ...buckets]}\n            />\n          </div>\n          <div className=\"column small-12\">\n            <div className=\"top-destinations-map-container\" style={{ height, width }}>\n              <Map\n                testId={`${testId}-d3`}\n                topoJSONPath={this.getTopoJsonLink()}\n                topoJSONRoot={this.getTopoJsonRoot()}\n                getPolygonTestId={this.getPolygonTestId}\n                getPolygonClassName={this.getPolygonClassName}\n                showTooltipCallback={this.onMouseMove}\n                hideTooltipCallback={this.onMouseLeave}\n                useRobinsonProjection={!activeTab}\n              />\n            </div>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nTopDestinationsMap.propTypes = {\n  testId: PropTypes.string,\n  printMode: PropTypes.bool,\n  nodeName: PropTypes.string,\n  activeTab: PropTypes.string,\n  profileType: PropTypes.string,\n  countryName: PropTypes.string,\n  commodityName: PropTypes.string,\n  verb: PropTypes.string.isRequired,\n  lines: PropTypes.array.isRequired,\n  year: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  buckets: PropTypes.array.isRequired,\n  includedYears: PropTypes.array.isRequired\n};\n\nexport default TopDestinationsMap;\n"]}]}