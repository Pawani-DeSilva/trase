{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx","mtime":1548345115529},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n/* eslint-disable jsx-a11y/no-static-element-interactions,jsx-a11y/no-noninteractive-element-interactions jsx-a11y/mouse-events-have-key-events */\n\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport get from 'lodash/get';\nimport Tooltip from 'tooltip.js';\nimport AutosizeInput from 'react-input-autosize';\nimport Dropdown from '../../shared/dropdown.component';\nimport './filter-tooltip.scss';\nvar FILTER_OPTIONS_MAP = {\n  lt: 'lower than',\n  gt: 'greater than',\n  eq: 'equals'\n};\n\nvar FilterTooltipComponent =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(FilterTooltipComponent, _Component);\n\n  function FilterTooltipComponent(props) {\n    var _this;\n\n    _classCallCheck(this, FilterTooltipComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FilterTooltipComponent).call(this, props));\n\n    _this.valueRenderer = function (value) {\n      return FILTER_OPTIONS_MAP[value];\n    };\n\n    _this.tooltipElement = null;\n    _this.tooltip = null;\n    _this.tooltipVeil = null;\n    _this.handleBodyClick = _this.handleBodyClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleDropdownValueChange = _this.handleDropdownValueChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleFilterIconClick = _this.handleFilterIconClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleInputValueChange = _this.handleInputValueChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleOperationChange = _this.handleOperationChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleFilterClearClick = _this.handleFilterClearClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(FilterTooltipComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.initTooltip();\n      document.body.addEventListener('click', this.handleBodyClick);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.destroyTooltip();\n      document.body.removeEventListener('click', this.handleBodyClick);\n    }\n  }, {\n    key: \"setDefaultFilter\",\n    value: function setDefaultFilter() {\n      var indicator = this.props.indicator;\n      var options = get(indicator, 'filterOptions.ops', []);\n      var op = options.includes('gt') ? 'gt' : options[0];\n      var val = get(indicator, 'filterOptions.values[0]', 0);\n      this.changeFilter({\n        op: op,\n        val: val\n      });\n    }\n  }, {\n    key: \"handleBodyClick\",\n    value: function handleBodyClick(event) {\n      if (this.contentElement.contains(event.target)) return;\n      this.closeTooltip();\n    }\n  }, {\n    key: \"handleDropdownValueChange\",\n    value: function handleDropdownValueChange(val) {\n      this.changeFilter({\n        val: val\n      });\n    }\n  }, {\n    key: \"handleFilterClearClick\",\n    value: function handleFilterClearClick() {\n      var _this$props = this.props,\n          onClear = _this$props.onClear,\n          indicator = _this$props.indicator;\n      this.closeTooltip();\n      if (onClear) onClear(indicator.id);\n    }\n  }, {\n    key: \"handleFilterIconClick\",\n    value: function handleFilterIconClick() {\n      if (!this.props.selectedFilter) {\n        this.setDefaultFilter();\n      }\n\n      this.tooltip.show();\n      this.createTooltipVeil();\n      this.forceUpdate(); // rerender autosize input\n    }\n  }, {\n    key: \"handleInputValueChange\",\n    value: function handleInputValueChange(event) {\n      this.changeFilter({\n        val: event.target.value\n      });\n    }\n  }, {\n    key: \"handleOperationChange\",\n    value: function handleOperationChange(op) {\n      this.changeFilter({\n        op: op\n      });\n    }\n  }, {\n    key: \"changeFilter\",\n    value: function changeFilter(filter) {\n      var _this$props2 = this.props,\n          indicator = _this$props2.indicator,\n          selectedFilter = _this$props2.selectedFilter,\n          onChange = _this$props2.onChange;\n\n      if (onChange) {\n        onChange(_objectSpread({\n          name: indicator.id\n        }, selectedFilter, filter));\n      }\n    }\n  }, {\n    key: \"initTooltip\",\n    value: function initTooltip() {\n      this.tooltip = new Tooltip(this.element, {\n        title: this.contentElement,\n        placement: 'top',\n        container: 'body',\n        boundariesElement: 'window',\n        template: '<div class=\"tooltip filter-tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\n        trigger: 'manual',\n        html: true\n      }); // workaround for ios not closing tooltips\n\n      var iOS = /iPhone|iPad|iPod/.test(navigator.platform) && !window.MSStream;\n\n      if (iOS) {\n        document.body.classList.add('tooltip-ios-touch');\n      }\n    }\n  }, {\n    key: \"createTooltipVeil\",\n    value: function createTooltipVeil() {\n      var veil = document.createElement('div');\n      veil.classList.add('veil');\n      document.body.appendChild(veil);\n      this.tooltipVeil = veil;\n    }\n  }, {\n    key: \"closeTooltip\",\n    value: function closeTooltip() {\n      if (!this.tooltip) return;\n      this.tooltip.hide();\n      this.destroyTooltipVeil();\n    }\n  }, {\n    key: \"destroyTooltip\",\n    value: function destroyTooltip() {\n      if (!this.tooltip) return;\n      this.destroyTooltipVeil();\n      this.tooltip.dispose();\n    }\n  }, {\n    key: \"destroyTooltipVeil\",\n    value: function destroyTooltipVeil() {\n      if (this.tooltipVeil) {\n        document.body.removeChild(this.tooltipVeil);\n        this.tooltipVeil = null;\n      }\n    }\n  }, {\n    key: \"renderValueInput\",\n    value: function renderValueInput() {\n      var _this$props3 = this.props,\n          indicator = _this$props3.indicator,\n          selectedFilter = _this$props3.selectedFilter;\n      if (!selectedFilter) return null;\n\n      if (indicator.filterOptions.values) {\n        return React.createElement(Dropdown, {\n          value: selectedFilter.val,\n          valueList: indicator.filterOptions.values,\n          onValueSelected: this.handleDropdownValueChange\n        });\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(AutosizeInput, {\n        type: \"number\",\n        minWidth: \"30\",\n        value: selectedFilter.val,\n        onChange: this.handleInputValueChange\n      }), indicator.unit);\n    }\n  }, {\n    key: \"renderTooltipContent\",\n    value: function renderTooltipContent() {\n      var _this2 = this;\n\n      var _this$props4 = this.props,\n          indicator = _this$props4.indicator,\n          selectedFilter = _this$props4.selectedFilter;\n      return React.createElement(\"div\", {\n        className: \"tooltip-content\",\n        ref: function ref(elem) {\n          _this2.contentElement = elem;\n        }\n      }, React.createElement(\"div\", {\n        className: \"title\"\n      }, React.createElement(\"div\", null, \"FILTER INDICATOR\"), React.createElement(\"div\", {\n        className: \"clear-filter\",\n        onClick: this.handleFilterClearClick\n      }, \"DELETE\", React.createElement(\"svg\", {\n        className: \"icon\"\n      }, React.createElement(\"use\", {\n        xlinkHref: \"#icon-delete\"\n      })))), React.createElement(\"div\", {\n        className: \"content\"\n      }, indicator.filterName, React.createElement(Dropdown, {\n        value: selectedFilter && selectedFilter.op,\n        valueRenderer: this.valueRenderer,\n        valueList: indicator.filterOptions.ops,\n        onValueSelected: this.handleOperationChange\n      }), this.renderValueInput()));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var filterIcon = this.props.selectedFilter ? 'filter-filled' : 'filter';\n      return React.createElement(\"div\", {\n        ref: function ref(elem) {\n          _this3.element = elem;\n        },\n        className: cx('tooltip-react filter-tooltip', {\n          '-selected': this.props.selectedFilter\n        })\n      }, React.createElement(\"svg\", {\n        className: \"icon tooltip-react-icon\",\n        onClick: this.handleFilterIconClick\n      }, React.createElement(\"use\", {\n        xlinkHref: \"#icon-\".concat(filterIcon)\n      })), this.renderTooltipContent());\n    }\n  }]);\n\n  return FilterTooltipComponent;\n}(Component);\n\nexport { FilterTooltipComponent as default };\nFilterTooltipComponent.propTypes = {\n  indicator: PropTypes.any,\n  selectedFilter: PropTypes.shape({\n    name: PropTypes.string,\n    op: PropTypes.string,\n    val: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n  }),\n  onChange: PropTypes.func,\n  onClear: PropTypes.func\n};\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_typeof, \"_typeof\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_objectSpread, \"_objectSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_defineProperty, \"_defineProperty\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_defineProperties, \"_defineProperties\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_getPrototypeOf, \"_getPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_setPrototypeOf, \"_setPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(_assertThisInitialized, \"_assertThisInitialized\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(FILTER_OPTIONS_MAP, \"FILTER_OPTIONS_MAP\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  reactHotLoader.register(FilterTooltipComponent, \"FilterTooltipComponent\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/data-portal/filter-tooltip/filter-tooltip.component.jsx"],"names":["FILTER_OPTIONS_MAP","lt","gt","eq","FilterTooltipComponent","Component","document","indicator","options","get","op","val","event","onClear","value","filter","selectedFilter","onChange","name","id","title","placement","container","boundariesElement","template","trigger","html","iOS","navigator","window","veil","handleDropdownValueChange","handleInputValueChange","handleFilterClearClick","handleOperationChange","filterIcon","cx","handleFilterIconClick","PropTypes","func"],"mappings":"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","sourcesContent":["/* eslint-disable jsx-a11y/no-static-element-interactions,jsx-a11y/no-noninteractive-element-interactions jsx-a11y/mouse-events-have-key-events */\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport get from 'lodash/get';\nimport Tooltip from 'tooltip.js';\nimport AutosizeInput from 'react-input-autosize';\n\nimport Dropdown from '../../shared/dropdown.component';\n\nimport './filter-tooltip.scss';\n\nconst FILTER_OPTIONS_MAP = {\n  lt: 'lower than',\n  gt: 'greater than',\n  eq: 'equals'\n};\n\nexport default class FilterTooltipComponent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.valueRenderer = value => FILTER_OPTIONS_MAP[value];\n    this.tooltipElement = null;\n    this.tooltip = null;\n    this.tooltipVeil = null;\n\n    this.handleBodyClick = this.handleBodyClick.bind(this);\n    this.handleDropdownValueChange = this.handleDropdownValueChange.bind(this);\n    this.handleFilterIconClick = this.handleFilterIconClick.bind(this);\n    this.handleInputValueChange = this.handleInputValueChange.bind(this);\n    this.handleOperationChange = this.handleOperationChange.bind(this);\n    this.handleFilterClearClick = this.handleFilterClearClick.bind(this);\n  }\n\n  componentDidMount() {\n    this.initTooltip();\n    document.body.addEventListener('click', this.handleBodyClick);\n  }\n\n  componentWillUnmount() {\n    this.destroyTooltip();\n    document.body.removeEventListener('click', this.handleBodyClick);\n  }\n\n  setDefaultFilter() {\n    const { indicator } = this.props;\n\n    const options = get(indicator, 'filterOptions.ops', []);\n    const op = options.includes('gt') ? 'gt' : options[0];\n    const val = get(indicator, 'filterOptions.values[0]', 0);\n\n    this.changeFilter({ op, val });\n  }\n\n  handleBodyClick(event) {\n    if (this.contentElement.contains(event.target)) return;\n    this.closeTooltip();\n  }\n\n  handleDropdownValueChange(val) {\n    this.changeFilter({ val });\n  }\n\n  handleFilterClearClick() {\n    const { onClear, indicator } = this.props;\n    this.closeTooltip();\n    if (onClear) onClear(indicator.id);\n  }\n\n  handleFilterIconClick() {\n    if (!this.props.selectedFilter) {\n      this.setDefaultFilter();\n    }\n    this.tooltip.show();\n    this.createTooltipVeil();\n    this.forceUpdate(); // rerender autosize input\n  }\n\n  handleInputValueChange(event) {\n    this.changeFilter({ val: event.target.value });\n  }\n\n  handleOperationChange(op) {\n    this.changeFilter({ op });\n  }\n\n  changeFilter(filter) {\n    const { indicator, selectedFilter, onChange } = this.props;\n\n    if (onChange) {\n      onChange({\n        name: indicator.id,\n        ...selectedFilter,\n        ...filter\n      });\n    }\n  }\n\n  initTooltip() {\n    this.tooltip = new Tooltip(this.element, {\n      title: this.contentElement,\n      placement: 'top',\n      container: 'body',\n      boundariesElement: 'window',\n      template:\n        '<div class=\"tooltip filter-tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\n      trigger: 'manual',\n      html: true\n    });\n\n    // workaround for ios not closing tooltips\n    const iOS = /iPhone|iPad|iPod/.test(navigator.platform) && !window.MSStream;\n    if (iOS) {\n      document.body.classList.add('tooltip-ios-touch');\n    }\n  }\n\n  createTooltipVeil() {\n    const veil = document.createElement('div');\n    veil.classList.add('veil');\n    document.body.appendChild(veil);\n    this.tooltipVeil = veil;\n  }\n\n  closeTooltip() {\n    if (!this.tooltip) return;\n    this.tooltip.hide();\n    this.destroyTooltipVeil();\n  }\n\n  destroyTooltip() {\n    if (!this.tooltip) return;\n    this.destroyTooltipVeil();\n    this.tooltip.dispose();\n  }\n\n  destroyTooltipVeil() {\n    if (this.tooltipVeil) {\n      document.body.removeChild(this.tooltipVeil);\n      this.tooltipVeil = null;\n    }\n  }\n\n  renderValueInput() {\n    const { indicator, selectedFilter } = this.props;\n\n    if (!selectedFilter) return null;\n\n    if (indicator.filterOptions.values) {\n      return (\n        <Dropdown\n          value={selectedFilter.val}\n          valueList={indicator.filterOptions.values}\n          onValueSelected={this.handleDropdownValueChange}\n        />\n      );\n    }\n\n    return (\n      <React.Fragment>\n        <AutosizeInput\n          type=\"number\"\n          minWidth=\"30\"\n          value={selectedFilter.val}\n          onChange={this.handleInputValueChange}\n        />\n        {indicator.unit}\n      </React.Fragment>\n    );\n  }\n\n  renderTooltipContent() {\n    const { indicator, selectedFilter } = this.props;\n\n    return (\n      <div\n        className=\"tooltip-content\"\n        ref={elem => {\n          this.contentElement = elem;\n        }}\n      >\n        <div className=\"title\">\n          <div>FILTER INDICATOR</div>\n          <div className=\"clear-filter\" onClick={this.handleFilterClearClick}>\n            DELETE\n            <svg className=\"icon\">\n              <use xlinkHref=\"#icon-delete\" />\n            </svg>\n          </div>\n        </div>\n        <div className=\"content\">\n          {indicator.filterName}\n          <Dropdown\n            value={selectedFilter && selectedFilter.op}\n            valueRenderer={this.valueRenderer}\n            valueList={indicator.filterOptions.ops}\n            onValueSelected={this.handleOperationChange}\n          />\n          {this.renderValueInput()}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const filterIcon = this.props.selectedFilter ? 'filter-filled' : 'filter';\n\n    return (\n      <div\n        ref={elem => {\n          this.element = elem;\n        }}\n        className={cx('tooltip-react filter-tooltip', { '-selected': this.props.selectedFilter })}\n      >\n        <svg className=\"icon tooltip-react-icon\" onClick={this.handleFilterIconClick}>\n          <use xlinkHref={`#icon-${filterIcon}`} />\n        </svg>\n\n        {this.renderTooltipContent()}\n      </div>\n    );\n  }\n}\n\nFilterTooltipComponent.propTypes = {\n  indicator: PropTypes.any,\n  selectedFilter: PropTypes.shape({\n    name: PropTypes.string,\n    op: PropTypes.string,\n    val: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n  }),\n  onChange: PropTypes.func,\n  onClear: PropTypes.func\n};\n"]}]}