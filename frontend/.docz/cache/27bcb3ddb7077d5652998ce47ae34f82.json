{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx","mtime":1548345115568},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n/* eslint-disable jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */\n\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Downshift from 'downshift';\nimport debounce from 'lodash/debounce';\nimport isEmpty from 'lodash/isEmpty';\nimport kebabCase from 'lodash/kebabCase';\nimport GlobalSearchResult from 'react-components/nav/global-search/global-search-result/global-search-result.component';\nimport { MAX_SEARCH_RESULTS } from 'constants';\nimport 'react-components/nav/global-search/global-search.scss';\nimport 'react-components/nav/global-search/global-search-result/global-search-result.scss';\nvar SEARCH_DEBOUNCE_RATE_IN_MS = 400;\n\nvar GlobalSearch =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(GlobalSearch, _Component);\n\n  function GlobalSearch(props) {\n    var _this;\n\n    _classCallCheck(this, GlobalSearch);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(GlobalSearch).call(this, props));\n    _this.state = {\n      isSearchOpen: false,\n      inputValue: ''\n    };\n    _this.onOpenClicked = _this.onOpenClicked.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onCloseClicked = _this.onCloseClicked.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onKeydown = _this.onKeydown.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onDownshiftStateChange = _this.onDownshiftStateChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onItemSelected = _this.onItemSelected.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.debouncedInputValueChange = debounce(_this.debouncedInputValueChange.bind(_assertThisInitialized(_assertThisInitialized(_this))), SEARCH_DEBOUNCE_RATE_IN_MS);\n    _this.onInputValueChange = _this.onInputValueChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this.setDownshiftRef = function (element) {\n      _this.downshift = element;\n    };\n\n    _this.setInputRef = function (element) {\n      _this.input = element;\n    };\n\n    document.addEventListener('keydown', _this.onKeydown);\n    return _this;\n  }\n\n  _createClass(GlobalSearch, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.input && !prevState.isSearchOpen && this.state.isSearchOpen) {\n        this.input.focus();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // reset search term when removing this component\n      this.debouncedInputValueChange('');\n      document.removeEventListener('keydown', this.onKeydown);\n    }\n  }, {\n    key: \"onOpenClicked\",\n    value: function onOpenClicked(e) {\n      if (e) e.stopPropagation();\n      this.setState({\n        isSearchOpen: true\n      });\n    }\n  }, {\n    key: \"onCloseClicked\",\n    value: function onCloseClicked(e) {\n      if (e) e.stopPropagation();\n      this.setState({\n        isSearchOpen: false,\n        inputValue: ''\n      });\n      this.debouncedInputValueChange('');\n    }\n  }, {\n    key: \"onItemSelected\",\n    value: function onItemSelected(item) {\n      this.onCloseClicked();\n      this.props.onItemSelected(item);\n    }\n  }, {\n    key: \"onDownshiftStateChange\",\n    value: function onDownshiftStateChange(state) {\n      if (state.inputValue !== undefined) this.onInputValueChange(state.inputValue);\n    }\n  }, {\n    key: \"onInputValueChange\",\n    value: function onInputValueChange(value) {\n      this.setState({\n        inputValue: value\n      });\n      this.debouncedInputValueChange(value);\n    }\n  }, {\n    key: \"onKeydown\",\n    value: function onKeydown(e) {\n      if (e.key === 'Escape' && this.state.isSearchOpen) {\n        this.onCloseClicked();\n      }\n    }\n  }, {\n    key: \"debouncedInputValueChange\",\n    value: function debouncedInputValueChange(value) {\n      this.props.onInputValueChange(value);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          isLoading = _this$props.isLoading,\n          className = _this$props.className,\n          _this$props$searchRes = _this$props.searchResults,\n          searchResults = _this$props$searchRes === void 0 ? [] : _this$props$searchRes,\n          searchTerm = _this$props.searchTerm;\n      var _this$state = this.state,\n          isSearchOpen = _this$state.isSearchOpen,\n          inputValue = _this$state.inputValue;\n      var noResults = !searchResults.length && !isLoading && !isEmpty(searchTerm);\n\n      if (!isSearchOpen) {\n        return React.createElement(\"div\", {\n          onClick: this.onOpenClicked,\n          className: className,\n          \"data-test\": \"global-search-toggle\"\n        }, React.createElement(\"svg\", {\n          className: \"icon icon-search\"\n        }, React.createElement(\"use\", {\n          xlinkHref: \"#icon-search\"\n        })));\n      }\n\n      return React.createElement(\"div\", {\n        className: \"c-search -global\"\n      }, isLoading ? React.createElement(\"span\", {\n        className: \"search-spinner\"\n      }) : React.createElement(\"svg\", {\n        className: \"icon icon-search\"\n      }, React.createElement(\"use\", {\n        xlinkHref: \"#icon-search\"\n      })), React.createElement(\"div\", {\n        className: \"c-search__veil\",\n        onClick: this.onCloseClicked\n      }), React.createElement(\"div\", {\n        className: \"search-wrapper\"\n      }, React.createElement(Downshift, {\n        itemToString: function itemToString(i) {\n          if (i === null) return '';\n          if (_typeof(i) === 'object') return i.name;\n          return i;\n        },\n        selectedItem: inputValue,\n        onStateChange: this.onDownshiftStateChange,\n        onChange: this.onItemSelected,\n        ref: this.setDownshiftRef\n      }, function (_ref) {\n        var getInputProps = _ref.getInputProps,\n            getItemProps = _ref.getItemProps,\n            highlightedIndex = _ref.highlightedIndex;\n        return React.createElement(\"div\", {\n          className: \"search-container\",\n          onClick: function onClick(e) {\n            return e.stopPropagation();\n          }\n        }, React.createElement(\"div\", {\n          className: \"search-bar\"\n        }, React.createElement(\"input\", _extends({}, getInputProps({\n          placeholder: 'Search a producer, trader or country of import'\n        }), {\n          ref: _this2.setInputRef,\n          autoComplete: \"off\",\n          className: \"search-bar-input\",\n          type: \"search\",\n          \"data-test\": \"global-search-input\"\n        }))), !isEmpty(searchTerm) && React.createElement(\"ul\", {\n          className: \"search-results\"\n        }, searchResults.slice(0, MAX_SEARCH_RESULTS).map(function (item, row) {\n          return React.createElement(GlobalSearchResult, {\n            key: row,\n            value: searchTerm,\n            isLoading: isLoading,\n            isHighlighted: row === highlightedIndex,\n            item: item,\n            itemProps: getItemProps({\n              item: item\n            }),\n            testId: \"global-search-result-\".concat(kebabCase(item.name), \"-\").concat(item.contextId).toLowerCase()\n          });\n        }), noResults && React.createElement(\"li\", {\n          className: \"c-search-result -no-highlight\"\n        }, React.createElement(\"div\", {\n          className: \"search-node-text-container\"\n        }, React.createElement(\"span\", {\n          className: \"search-node-name\",\n          \"data-test\": \"global-search-no-result\"\n        }, \"No results found\")))));\n      })));\n    }\n  }]);\n\n  return GlobalSearch;\n}(Component);\n\nexport { GlobalSearch as default };\nGlobalSearch.propTypes = {\n  className: PropTypes.string,\n  isLoading: PropTypes.bool,\n  onInputValueChange: PropTypes.func,\n  onItemSelected: PropTypes.func,\n  searchResults: PropTypes.array,\n  searchTerm: PropTypes.string\n};\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_extends, \"_extends\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_typeof, \"_typeof\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_defineProperties, \"_defineProperties\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_getPrototypeOf, \"_getPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_setPrototypeOf, \"_setPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(_assertThisInitialized, \"_assertThisInitialized\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(SEARCH_DEBOUNCE_RATE_IN_MS, \"SEARCH_DEBOUNCE_RATE_IN_MS\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  reactHotLoader.register(GlobalSearch, \"GlobalSearch\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/nav/global-search/global-search.component.jsx"],"names":["SEARCH_DEBOUNCE_RATE_IN_MS","GlobalSearch","Component","isSearchOpen","inputValue","debounce","document","prevProps","prevState","e","item","state","value","isLoading","className","searchResults","searchTerm","noResults","isEmpty","onCloseClicked","i","setDownshiftRef","getInputProps","getItemProps","highlightedIndex","placeholder","row","kebabCase","PropTypes","onInputValueChange","onItemSelected","string"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;AACA,OAAA,KAAA,IAAA,SAAA,QAAA,OAAA;AACA,OAAA,SAAA,MAAA,YAAA;AACA,OAAA,SAAA,MAAA,WAAA;AACA,OAAA,QAAA,MAAA,iBAAA;AACA,OAAA,OAAA,MAAA,gBAAA;AACA,OAAA,SAAA,MAAA,kBAAA;AACA,OAAA,kBAAA,MAAA,wFAAA;AACA,SAAA,kBAAA,QAAA,WAAA;AAEA,OAAA,uDAAA;AACA,OAAA,mFAAA;AAEA,IAAMA,0BAA0B,GAAhC,GAAA;;IAEqBC,Y;;;;;AACnB,WAAA,YAAA,CAAA,KAAA,EAAmB;AAAA,QAAA,KAAA;;AAAA,IAAA,eAAA,CAAA,IAAA,EAAA,YAAA,CAAA;;AACjB,IAAA,KAAA,GAAA,0BAAA,CAAA,IAAA,EAAA,eAAA,CAAA,YAAA,CAAA,CAAA,IAAA,CAAA,IAAA,EAAA,KAAA,CAAA,CAAA;AACA,IAAA,KAAA,CAAA,KAAA,GAAa;AAAEE,MAAAA,YAAY,EAAd,KAAA;AAAuBC,MAAAA,UAAU,EAAE;AAAnC,KAAb;AACA,IAAA,KAAA,CAAA,aAAA,GAAqB,KAAA,CAAA,aAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CAArB,KAAqB,CAAA,CAAA,CAArB;AACA,IAAA,KAAA,CAAA,cAAA,GAAsB,KAAA,CAAA,cAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CAAtB,KAAsB,CAAA,CAAA,CAAtB;AACA,IAAA,KAAA,CAAA,SAAA,GAAiB,KAAA,CAAA,SAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CAAjB,KAAiB,CAAA,CAAA,CAAjB;AACA,IAAA,KAAA,CAAA,sBAAA,GAA8B,KAAA,CAAA,sBAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CAA9B,KAA8B,CAAA,CAAA,CAA9B;AACA,IAAA,KAAA,CAAA,cAAA,GAAsB,KAAA,CAAA,cAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CAAtB,KAAsB,CAAA,CAAA,CAAtB;AACA,IAAA,KAAA,CAAA,yBAAA,GAAiCC,QAAQ,CACvC,KAAA,CAAA,yBAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CADuC,KACvC,CAAA,CAAA,CADuC,EAAzC,0BAAyC,CAAzC;AAIA,IAAA,KAAA,CAAA,kBAAA,GAA0B,KAAA,CAAA,kBAAA,CAAA,IAAA,CAAA,sBAAA,CAAA,sBAAA,CAA1B,KAA0B,CAAA,CAAA,CAA1B;;AACA,IAAA,KAAA,CAAA,eAAA,GAAuB,UAAA,OAAA,EAAW;AAChC,MAAA,KAAA,CAAA,SAAA,GAAA,OAAA;AADF,KAAA;;AAGA,IAAA,KAAA,CAAA,WAAA,GAAmB,UAAA,OAAA,EAAW;AAC5B,MAAA,KAAA,CAAA,KAAA,GAAA,OAAA;AADF,KAAA;;AAIAC,IAAAA,QAAQ,CAARA,gBAAAA,CAAAA,SAAAA,EAAqC,KAAA,CAArCA,SAAAA;AApBiB,WAAA,KAAA;AAqBlB;;;;uCAEkBC,S,EAAWC,S,EAAW;AACvC,UAAI,KAAA,KAAA,IAAc,CAACA,SAAS,CAAxB,YAAA,IAAyC,KAAA,KAAA,CAA7C,YAAA,EAAsE;AACpE,aAAA,KAAA,CAAA,KAAA;AACD;AACF;;;2CAEsB;AACrB;AACA,WAAA,yBAAA,CAAA,EAAA;AACAF,MAAAA,QAAQ,CAARA,mBAAAA,CAAAA,SAAAA,EAAwC,KAAxCA,SAAAA;AACD;;;kCAEaG,C,EAAG;AACf,UAAA,CAAA,EAAOA,CAAC,CAADA,eAAAA;AACP,WAAA,QAAA,CAAc;AAAEN,QAAAA,YAAY,EAAE;AAAhB,OAAd;AACD;;;mCAEcM,C,EAAG;AAChB,UAAA,CAAA,EAAOA,CAAC,CAADA,eAAAA;AACP,WAAA,QAAA,CAAc;AAAEN,QAAAA,YAAY,EAAd,KAAA;AAAuBC,QAAAA,UAAU,EAAE;AAAnC,OAAd;AACA,WAAA,yBAAA,CAAA,EAAA;AACD;;;mCAEcM,I,EAAM;AACnB,WAAA,cAAA;AACA,WAAA,KAAA,CAAA,cAAA,CAAA,IAAA;AACD;;;2CAEsBC,K,EAAO;AAC5B,UAAIA,KAAK,CAALA,UAAAA,KAAJ,SAAA,EAAoC,KAAA,kBAAA,CAAwBA,KAAK,CAA7B,UAAA;AACrC;;;uCAEkBC,K,EAAO;AACxB,WAAA,QAAA,CAAc;AAAER,QAAAA,UAAU,EAAEQ;AAAd,OAAd;AACA,WAAA,yBAAA,CAAA,KAAA;AACD;;;8BAESH,C,EAAG;AACX,UAAIA,CAAC,CAADA,GAAAA,KAAAA,QAAAA,IAAsB,KAAA,KAAA,CAA1B,YAAA,EAAmD;AACjD,aAAA,cAAA;AACD;AACF;;;8CAEyBG,K,EAAO;AAC/B,WAAA,KAAA,CAAA,kBAAA,CAAA,KAAA;AACD;;;6BAEQ;AAAA,UAAA,MAAA,GAAA,IAAA;;AAAA,UAAA,WAAA,GAC0D,KAD1D,KAAA;AAAA,UACCC,SADD,GAAA,WAAA,CAAA,SAAA;AAAA,UACYC,SADZ,GAAA,WAAA,CAAA,SAAA;AAAA,UAAA,qBAAA,GAAA,WAAA,CAAA,aAAA;AAAA,UACuBC,aADvB,GAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,qBAAA;AAAA,UAC2CC,UAD3C,GAAA,WAAA,CAAA,UAAA;AAAA,UAAA,WAAA,GAE8B,KAF9B,KAAA;AAAA,UAECb,YAFD,GAAA,WAAA,CAAA,YAAA;AAAA,UAEeC,UAFf,GAAA,WAAA,CAAA,UAAA;AAGP,UAAMa,SAAS,GAAG,CAACF,aAAa,CAAd,MAAA,IAAyB,CAAzB,SAAA,IAAuC,CAACG,OAAO,CAAjE,UAAiE,CAAjE;;AAEA,UAAI,CAAJ,YAAA,EAAmB;AACjB,eACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,UAAA,OAAO,EAAE,KAAd,aAAA;AAAkC,UAAA,SAAS,EAA3C,SAAA;AAAwD,uBAAU;AAAlE,SAAA,EACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,CADF,CADF,CADF;AAOD;;AAED,aACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,EACGL,SAAS,GACR,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AAAM,QAAA,SAAS,EAAC;AAAhB,OAAA,CADQ,GAGR,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,EACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,CADF,CAJJ,EAQE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAd,gBAAA;AAAgC,QAAA,OAAO,EAAE,KAAKM;AAA9C,OAAA,CARF,EASE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,EACE,KAAA,CAAA,aAAA,CAAA,SAAA,EAAA;AACE,QAAA,YAAY,EAAE,SAAA,YAAA,CAAA,CAAA,EAAK;AACjB,cAAIC,CAAC,KAAL,IAAA,EAAgB,OAAA,EAAA;AAChB,cAAI,OAAA,CAAA,CAAA,CAAA,KAAJ,QAAA,EAA2B,OAAOA,CAAC,CAAR,IAAA;AAC3B,iBAAA,CAAA;AAJJ,SAAA;AAME,QAAA,YAAY,EANd,UAAA;AAOE,QAAA,aAAa,EAAE,KAPjB,sBAAA;AAQE,QAAA,QAAQ,EAAE,KARZ,cAAA;AASE,QAAA,GAAG,EAAE,KAAKC;AATZ,OAAA,EAWG,UAAA,IAAA,EAAA;AAAA,YAAGC,aAAH,GAAA,IAAA,CAAA,aAAA;AAAA,YAAkBC,YAAlB,GAAA,IAAA,CAAA,YAAA;AAAA,YAAgCC,gBAAhC,GAAA,IAAA,CAAA,gBAAA;AAAA,eACC,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,UAAA,SAAS,EAAd,kBAAA;AAAkC,UAAA,OAAO,EAAE,SAAA,OAAA,CAAA,CAAA,EAAC;AAAA,mBAAIf,CAAC,CAAL,eAAIA,EAAJ;AAAA;AAA5C,SAAA,EACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EACE,KAAA,CAAA,aAAA,CAAA,OAAA,EAAA,QAAA,CAAA,EAAA,EACMa,aAAa,CAAC;AAChBG,UAAAA,WAAW,EAAE;AADG,SAAD,CADnB,EAAA;AAIE,UAAA,GAAG,EAAE,MAAI,CAJX,WAAA;AAKE,UAAA,YAAY,EALd,KAAA;AAME,UAAA,SAAS,EANX,kBAAA;AAOE,UAAA,IAAI,EAPN,QAAA;AAQE,uBAAU;AARZ,SAAA,CAAA,CADF,CADF,EAaG,CAACP,OAAO,CAAR,UAAQ,CAAR,IACC,KAAA,CAAA,aAAA,CAAA,IAAA,EAAA;AAAI,UAAA,SAAS,EAAC;AAAd,SAAA,EACG,aAAa,CAAb,KAAA,CAAA,CAAA,EAAA,kBAAA,EAAA,GAAA,CAA+C,UAAA,IAAA,EAAA,GAAA,EAAA;AAAA,iBAC9C,KAAA,CAAA,aAAA,CAAA,kBAAA,EAAA;AACE,YAAA,GAAG,EADL,GAAA;AAEE,YAAA,KAAK,EAFP,UAAA;AAGE,YAAA,SAAS,EAHX,SAAA;AAIE,YAAA,aAAa,EAAEQ,GAAG,KAJpB,gBAAA;AAKE,YAAA,IAAI,EALN,IAAA;AAME,YAAA,SAAS,EAAEH,YAAY,CAAC;AAAEb,cAAAA,IAAI,EAAJA;AAAF,aAAD,CANzB;AAOE,YAAA,MAAM,EAAE,wBAAA,MAAA,CAAwBiB,SAAS,CAACjB,IAAI,CAAtC,IAAiC,CAAjC,EAAA,GAAA,EAAA,MAAA,CACNA,IAAI,CADE,SAAA,EAAA,WAAA;AAPV,WAAA,CAD8C;AADlD,SACG,CADH,EAcGO,SAAS,IACR,KAAA,CAAA,aAAA,CAAA,IAAA,EAAA;AAAI,UAAA,SAAS,EAAC;AAAd,SAAA,EACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EACE,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AAAM,UAAA,SAAS,EAAf,kBAAA;AAAmC,uBAAU;AAA7C,SAAA,EAhCb,kBAgCa,CADF,CADF,CAfJ,CAdJ,CADD;AAtBT,OAWM,CADF,CATF,CADF;AAoED;;;;EA1JuCf,S;;SAArBD,Y;AA6JrBA,YAAY,CAAZA,SAAAA,GAAyB;AACvBa,EAAAA,SAAS,EAAEc,SAAS,CADG,MAAA;AAEvBf,EAAAA,SAAS,EAAEe,SAAS,CAFG,IAAA;AAGvBC,EAAAA,kBAAkB,EAAED,SAAS,CAHN,IAAA;AAIvBE,EAAAA,cAAc,EAAEF,SAAS,CAJF,IAAA;AAKvBb,EAAAA,aAAa,EAAEa,SAAS,CALD,KAAA;AAMvBZ,EAAAA,UAAU,EAAEY,SAAS,CAACG;AANC,CAAzB9B;;;;;;;;;;;;;;;;;;;;;;0BA/JMD,0B;0BAEeC,Y","sourcesContent":["/* eslint-disable jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Downshift from 'downshift';\nimport debounce from 'lodash/debounce';\nimport isEmpty from 'lodash/isEmpty';\nimport kebabCase from 'lodash/kebabCase';\nimport GlobalSearchResult from 'react-components/nav/global-search/global-search-result/global-search-result.component';\nimport { MAX_SEARCH_RESULTS } from 'constants';\n\nimport 'react-components/nav/global-search/global-search.scss';\nimport 'react-components/nav/global-search/global-search-result/global-search-result.scss';\n\nconst SEARCH_DEBOUNCE_RATE_IN_MS = 400;\n\nexport default class GlobalSearch extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { isSearchOpen: false, inputValue: '' };\n    this.onOpenClicked = this.onOpenClicked.bind(this);\n    this.onCloseClicked = this.onCloseClicked.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onDownshiftStateChange = this.onDownshiftStateChange.bind(this);\n    this.onItemSelected = this.onItemSelected.bind(this);\n    this.debouncedInputValueChange = debounce(\n      this.debouncedInputValueChange.bind(this),\n      SEARCH_DEBOUNCE_RATE_IN_MS\n    );\n    this.onInputValueChange = this.onInputValueChange.bind(this);\n    this.setDownshiftRef = element => {\n      this.downshift = element;\n    };\n    this.setInputRef = element => {\n      this.input = element;\n    };\n\n    document.addEventListener('keydown', this.onKeydown);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.input && !prevState.isSearchOpen && this.state.isSearchOpen) {\n      this.input.focus();\n    }\n  }\n\n  componentWillUnmount() {\n    // reset search term when removing this component\n    this.debouncedInputValueChange('');\n    document.removeEventListener('keydown', this.onKeydown);\n  }\n\n  onOpenClicked(e) {\n    if (e) e.stopPropagation();\n    this.setState({ isSearchOpen: true });\n  }\n\n  onCloseClicked(e) {\n    if (e) e.stopPropagation();\n    this.setState({ isSearchOpen: false, inputValue: '' });\n    this.debouncedInputValueChange('');\n  }\n\n  onItemSelected(item) {\n    this.onCloseClicked();\n    this.props.onItemSelected(item);\n  }\n\n  onDownshiftStateChange(state) {\n    if (state.inputValue !== undefined) this.onInputValueChange(state.inputValue);\n  }\n\n  onInputValueChange(value) {\n    this.setState({ inputValue: value });\n    this.debouncedInputValueChange(value);\n  }\n\n  onKeydown(e) {\n    if (e.key === 'Escape' && this.state.isSearchOpen) {\n      this.onCloseClicked();\n    }\n  }\n\n  debouncedInputValueChange(value) {\n    this.props.onInputValueChange(value);\n  }\n\n  render() {\n    const { isLoading, className, searchResults = [], searchTerm } = this.props;\n    const { isSearchOpen, inputValue } = this.state;\n    const noResults = !searchResults.length && !isLoading && !isEmpty(searchTerm);\n\n    if (!isSearchOpen) {\n      return (\n        <div onClick={this.onOpenClicked} className={className} data-test=\"global-search-toggle\">\n          <svg className=\"icon icon-search\">\n            <use xlinkHref=\"#icon-search\" />\n          </svg>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"c-search -global\">\n        {isLoading ? (\n          <span className=\"search-spinner\" />\n        ) : (\n          <svg className=\"icon icon-search\">\n            <use xlinkHref=\"#icon-search\" />\n          </svg>\n        )}\n        <div className=\"c-search__veil\" onClick={this.onCloseClicked} />\n        <div className=\"search-wrapper\">\n          <Downshift\n            itemToString={i => {\n              if (i === null) return '';\n              if (typeof i === 'object') return i.name;\n              return i;\n            }}\n            selectedItem={inputValue}\n            onStateChange={this.onDownshiftStateChange}\n            onChange={this.onItemSelected}\n            ref={this.setDownshiftRef}\n          >\n            {({ getInputProps, getItemProps, highlightedIndex }) => (\n              <div className=\"search-container\" onClick={e => e.stopPropagation()}>\n                <div className=\"search-bar\">\n                  <input\n                    {...getInputProps({\n                      placeholder: 'Search a producer, trader or country of import'\n                    })}\n                    ref={this.setInputRef}\n                    autoComplete=\"off\"\n                    className=\"search-bar-input\"\n                    type=\"search\"\n                    data-test=\"global-search-input\"\n                  />\n                </div>\n                {!isEmpty(searchTerm) && (\n                  <ul className=\"search-results\">\n                    {searchResults.slice(0, MAX_SEARCH_RESULTS).map((item, row) => (\n                      <GlobalSearchResult\n                        key={row}\n                        value={searchTerm}\n                        isLoading={isLoading}\n                        isHighlighted={row === highlightedIndex}\n                        item={item}\n                        itemProps={getItemProps({ item })}\n                        testId={`global-search-result-${kebabCase(item.name)}-${\n                          item.contextId\n                        }`.toLowerCase()}\n                      />\n                    ))}\n                    {noResults && (\n                      <li className=\"c-search-result -no-highlight\">\n                        <div className=\"search-node-text-container\">\n                          <span className=\"search-node-name\" data-test=\"global-search-no-result\">\n                            No results found\n                          </span>\n                        </div>\n                      </li>\n                    )}\n                  </ul>\n                )}\n              </div>\n            )}\n          </Downshift>\n        </div>\n      </div>\n    );\n  }\n}\n\nGlobalSearch.propTypes = {\n  className: PropTypes.string,\n  isLoading: PropTypes.bool,\n  onInputValueChange: PropTypes.func,\n  onItemSelected: PropTypes.func,\n  searchResults: PropTypes.array,\n  searchTerm: PropTypes.string\n};\n"]}]}