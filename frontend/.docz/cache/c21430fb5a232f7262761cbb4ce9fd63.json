{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx","mtime":1548858395357},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MultiTable from 'react-components/profiles/multi-table/multi-table.component';\nimport Widget from 'react-components/widgets/widget.component';\nimport { GET_PLACE_INDICATORS, GET_ACTOR_SUSTAINABILITY, GET_NODE_SUMMARY_URL } from 'utils/getURLFromParams';\nimport flatMap from 'lodash/flatMap';\nimport addApostrophe from 'utils/addApostrophe';\nimport ShrinkingSpinner from 'react-components/shared/shrinking-spinner/shrinking-spinner.component';\n\nvar SustainabilityTableWidget =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(SustainabilityTableWidget, _React$PureComponent);\n\n  function SustainabilityTableWidget() {\n    _classCallCheck(this, SustainabilityTableWidget);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SustainabilityTableWidget).apply(this, arguments));\n  }\n\n  _createClass(SustainabilityTableWidget, [{\n    key: \"getTitle\",\n    value: function getTitle(nodeName) {\n      var _this$props = this.props,\n          year = _this$props.year,\n          type = _this$props.type;\n\n      if (type === 'indicators') {\n        return 'Sustainability indicators:';\n      }\n\n      return React.createElement(\"span\", null, \"Deforestation risk associated with \", React.createElement(\"span\", {\n        className: \"notranslate\"\n      }, nodeName), addApostrophe(nodeName), \" top sourcing regions in\", ' ', React.createElement(\"span\", {\n        className: \"notranslate\"\n      }, year), \":\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      var _this$props2 = this.props,\n          year = _this$props2.year,\n          nodeId = _this$props2.nodeId,\n          contextId = _this$props2.contextId,\n          type = _this$props2.type,\n          className = _this$props2.className,\n          profileType = _this$props2.profileType,\n          testId = _this$props2.testId,\n          targetPayload = _this$props2.targetPayload;\n      var params = {\n        node_id: nodeId,\n        context_id: contextId,\n        year: year\n      };\n      var mainQuery = type === 'indicators' ? GET_PLACE_INDICATORS : GET_ACTOR_SUSTAINABILITY;\n      return React.createElement(Widget, {\n        query: [mainQuery, GET_NODE_SUMMARY_URL],\n        params: [params, _objectSpread({}, params, {\n          profile_type: profileType\n        })]\n      }, function (_ref) {\n        var data = _ref.data,\n            loading = _ref.loading,\n            error = _ref.error;\n\n        if (loading) {\n          return React.createElement(\"div\", {\n            className: \"spinner-section\",\n            \"data-test\": \"loading-section\"\n          }, React.createElement(ShrinkingSpinner, {\n            className: \"-large\"\n          }));\n        }\n\n        if (error) {\n          // TODO: display a proper error message to the user\n          console.error('Error loading sustainability table data for profile page', error);\n          return React.createElement(\"div\", {\n            className: \"spinner-section\",\n            \"data-test\": \"loading-section\"\n          }, React.createElement(ShrinkingSpinner, {\n            className: \"-large\"\n          }));\n        }\n\n        if (error) {\n          return null;\n        }\n\n        var rows = flatMap(data[mainQuery], function (e) {\n          return e.rows;\n        });\n\n        if (rows.length === 0) {\n          return null;\n        }\n\n        var values = flatMap(data[mainQuery], function (e) {\n          return e.values;\n        });\n\n        if (values.length === 0) {\n          return null;\n        }\n\n        var nodeName = data[GET_NODE_SUMMARY_URL].nodeName;\n        return React.createElement(\"section\", {\n          className: className,\n          \"data-test\": testId\n        }, React.createElement(\"div\", {\n          className: \"row\"\n        }, React.createElement(\"div\", {\n          className: \"small-12 columns\"\n        }, React.createElement(MultiTable, {\n          year: year,\n          contextId: contextId,\n          type: type === 'indicators' ? 't_head_places' : 't_head_actors',\n          data: data[mainQuery],\n          tabsTitle: _this.getTitle(nodeName),\n          target: function target(item) {\n            return item.name === 'Municipalities' ? 'profileNode' : null;\n          },\n          targetPayload: targetPayload,\n          testId: \"\".concat(testId, \"-multi\")\n        }))));\n      });\n    }\n  }]);\n\n  return SustainabilityTableWidget;\n}(React.PureComponent);\n\nSustainabilityTableWidget.propTypes = {\n  testId: PropTypes.string,\n  className: PropTypes.string,\n  type: PropTypes.string.isRequired,\n  year: PropTypes.number.isRequired,\n  nodeId: PropTypes.number.isRequired,\n  contextId: PropTypes.number.isRequired,\n  profileType: PropTypes.string.isRequired,\n  targetPayload: PropTypes.object.isRequired\n};\nvar _default = SustainabilityTableWidget;\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_typeof, \"_typeof\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_objectSpread, \"_objectSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_defineProperty, \"_defineProperty\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_defineProperties, \"_defineProperties\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_assertThisInitialized, \"_assertThisInitialized\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_getPrototypeOf, \"_getPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_setPrototypeOf, \"_setPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(SustainabilityTableWidget, \"SustainabilityTableWidget\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/sustainability-table-widget.component.jsx"],"names":["SustainabilityTableWidget","React","PureComponent","nodeName","year","type","addApostrophe","nodeId","contextId","className","profileType","testId","targetPayload","params","node_id","context_id","mainQuery","profile_type","data","loading","error","console","rows","flatMap","e","values","item","PropTypes","isRequired"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport MultiTable from 'react-components/profiles/multi-table/multi-table.component';\nimport Widget from 'react-components/widgets/widget.component';\nimport {\n  GET_PLACE_INDICATORS,\n  GET_ACTOR_SUSTAINABILITY,\n  GET_NODE_SUMMARY_URL\n} from 'utils/getURLFromParams';\nimport flatMap from 'lodash/flatMap';\nimport addApostrophe from 'utils/addApostrophe';\nimport ShrinkingSpinner from 'react-components/shared/shrinking-spinner/shrinking-spinner.component';\n\nclass SustainabilityTableWidget extends React.PureComponent {\n  getTitle(nodeName) {\n    const { year, type } = this.props;\n    if (type === 'indicators') {\n      return 'Sustainability indicators:';\n    }\n\n    return (\n      <span>\n        Deforestation risk associated with <span className=\"notranslate\">{nodeName}</span>\n        {addApostrophe(nodeName)} top sourcing regions in{' '}\n        <span className=\"notranslate\">{year}</span>:\n      </span>\n    );\n  }\n\n  render() {\n    const {\n      year,\n      nodeId,\n      contextId,\n      type,\n      className,\n      profileType,\n      testId,\n      targetPayload\n    } = this.props;\n    const params = { node_id: nodeId, context_id: contextId, year };\n    const mainQuery = type === 'indicators' ? GET_PLACE_INDICATORS : GET_ACTOR_SUSTAINABILITY;\n    return (\n      <Widget\n        query={[mainQuery, GET_NODE_SUMMARY_URL]}\n        params={[params, { ...params, profile_type: profileType }]}\n      >\n        {({ data, loading, error }) => {\n          if (loading) {\n            return (\n              <div className=\"spinner-section\" data-test=\"loading-section\">\n                <ShrinkingSpinner className=\"-large\" />\n              </div>\n            );\n          }\n\n          if (error) {\n            // TODO: display a proper error message to the user\n            console.error('Error loading sustainability table data for profile page', error);\n            return (\n              <div className=\"spinner-section\" data-test=\"loading-section\">\n                <ShrinkingSpinner className=\"-large\" />\n              </div>\n            );\n          }\n\n          if (error) {\n            return null;\n          }\n\n          const rows = flatMap(data[mainQuery], e => e.rows);\n\n          if (rows.length === 0) {\n            return null;\n          }\n\n          const values = flatMap(data[mainQuery], e => e.values);\n\n          if (values.length === 0) {\n            return null;\n          }\n\n          const { nodeName } = data[GET_NODE_SUMMARY_URL];\n          return (\n            <section className={className} data-test={testId}>\n              <div className=\"row\">\n                <div className=\"small-12 columns\">\n                  <MultiTable\n                    year={year}\n                    contextId={contextId}\n                    type={type === 'indicators' ? 't_head_places' : 't_head_actors'}\n                    data={data[mainQuery]}\n                    tabsTitle={this.getTitle(nodeName)}\n                    target={item => (item.name === 'Municipalities' ? 'profileNode' : null)}\n                    targetPayload={targetPayload}\n                    testId={`${testId}-multi`}\n                  />\n                </div>\n              </div>\n            </section>\n          );\n        }}\n      </Widget>\n    );\n  }\n}\n\nSustainabilityTableWidget.propTypes = {\n  testId: PropTypes.string,\n  className: PropTypes.string,\n  type: PropTypes.string.isRequired,\n  year: PropTypes.number.isRequired,\n  nodeId: PropTypes.number.isRequired,\n  contextId: PropTypes.number.isRequired,\n  profileType: PropTypes.string.isRequired,\n  targetPayload: PropTypes.object.isRequired\n};\n\nexport default SustainabilityTableWidget;\n"]}]}