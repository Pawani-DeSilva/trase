{"remainingRequest":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\",[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],[\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/react-hot-loader/babel.js\"],\"env\":{\"production\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"transform-react-remove-prop-types\",\"lodash\"]},\"test\":{\"presets\":[[\"@babel/env\",{\"useBuiltIns\":\"entry\"}],\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-syntax-dynamic-import\",\"@babel/plugin-syntax-object-rest-spread\",\"@babel/plugin-transform-exponentiation-operator\",[\"@babel/plugin-proposal-class-properties\",{\"spec\":true}],\"@babel/plugin-transform-modules-commonjs\",[\"module-resolver\",{\"alias\":{\"scripts\":\"./scripts\",\"actions\":\"./scripts/actions\",\"utils\":\"./scripts/utils\",\"reducers\":\"./scripts/reducers\",\"store\":\"./scripts/store\",\"components\":\"./scripts/components\",\"containers\":\"./scripts/containers\",\"constants\":\"./scripts/constants\",\"router\":\"./scripts/router\",\"react-components\":\"./scripts/react-components\",\"named-maps\":\"./scripts/named-maps\"}}]]}},\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx","dependencies":[{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx","mtime":1548345115579},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/.babelrc","mtime":1548840716937},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport TopDestinationsChart from 'react-components/profiles/top-destinations-chart.component';\nimport TopDestinationsMap from 'react-components/profiles/top-destinations-map.component';\nimport { GET_ACTOR_TOP_COUNTRIES, GET_ACTOR_TOP_SOURCES, GET_NODE_SUMMARY_URL } from 'utils/getURLFromParams';\nimport Widget from 'react-components/widgets/widget.component';\nimport ShrinkingSpinner from 'react-components/shared/shrinking-spinner/shrinking-spinner.component';\n\nvar TopDestinationsWidget =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(TopDestinationsWidget, _React$PureComponent);\n\n  function TopDestinationsWidget() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TopDestinationsWidget);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TopDestinationsWidget)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      activeTabIndex: _this.props.printMode && _this.props.contextId === 1 ? 1 : 0\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"updateTab\", function (index) {\n      return _this.setState({\n        activeTabIndex: index\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(TopDestinationsWidget, [{\n    key: \"getActiveTabProps\",\n    value: function getActiveTabProps(data) {\n      var activeTabIndex = this.state.activeTabIndex;\n\n      var tabs = _toConsumableArray(data.tabs).reverse();\n\n      var activeTab = tabs[activeTabIndex];\n      var linesData = data[activeTab];\n      var includedYears = data.includedYears,\n          buckets = data.buckets;\n      var lines = linesData.lines,\n          style = linesData.style,\n          unit = linesData.unit;\n      return {\n        tabs: tabs,\n        unit: unit,\n        lines: lines,\n        style: style,\n        buckets: buckets,\n        activeTab: activeTab,\n        includedYears: includedYears,\n        profileType: linesData.profile_type\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          printMode = _this$props.printMode,\n          year = _this$props.year,\n          nodeId = _this$props.nodeId,\n          contextId = _this$props.contextId,\n          type = _this$props.type,\n          className = _this$props.className,\n          commodityName = _this$props.commodityName,\n          countryName = _this$props.countryName,\n          onLinkClick = _this$props.onLinkClick,\n          testId = _this$props.testId;\n      var mainQuery = type === 'countries' ? GET_ACTOR_TOP_COUNTRIES : GET_ACTOR_TOP_SOURCES;\n      var params = {\n        node_id: nodeId,\n        context_id: contextId,\n        year: year\n      };\n      return React.createElement(Widget, {\n        query: [mainQuery, GET_NODE_SUMMARY_URL],\n        params: [_objectSpread({}, params, {\n          year: year\n        }), _objectSpread({}, params, {\n          profile_type: 'actor'\n        })]\n      }, function (_ref) {\n        var data = _ref.data,\n            loading = _ref.loading,\n            error = _ref.error;\n\n        if (loading) {\n          return React.createElement(\"div\", {\n            className: \"spinner-section\",\n            \"data-test\": \"loading-section\"\n          }, React.createElement(ShrinkingSpinner, {\n            className: \"-large\"\n          }));\n        }\n\n        if (error) {\n          // TODO: display a proper error message to the user\n          console.error('Error loading top destinations data for profile page', error);\n          return null;\n        }\n\n        var _this2$getActiveTabPr = _this2.getActiveTabProps(data[mainQuery]),\n            includedYears = _this2$getActiveTabPr.includedYears,\n            lines = _this2$getActiveTabPr.lines,\n            unit = _this2$getActiveTabPr.unit,\n            profileType = _this2$getActiveTabPr.profileType,\n            style = _this2$getActiveTabPr.style,\n            buckets = _this2$getActiveTabPr.buckets,\n            activeTab = _this2$getActiveTabPr.activeTab,\n            tabs = _this2$getActiveTabPr.tabs;\n\n        if (!lines || lines.length === 0) {\n          return null;\n        }\n\n        var _data$GET_NODE_SUMMAR = data[GET_NODE_SUMMARY_URL],\n            nodeName = _data$GET_NODE_SUMMAR.nodeName,\n            columnName = _data$GET_NODE_SUMMAR.columnName;\n        var verb = columnName === 'EXPORTER' ? 'exported' : 'imported';\n        return React.createElement(\"section\", {\n          className: className,\n          \"data-test\": testId\n        }, React.createElement(\"div\", {\n          className: \"row align-justify\"\n        }, React.createElement(\"div\", {\n          className: \"column small-12 medium-7\"\n        }, React.createElement(TopDestinationsChart, {\n          height: 250,\n          type: type,\n          tabs: tabs,\n          onChangeTab: _this2.updateTab,\n          onLinkClick: onLinkClick,\n          contextId: contextId,\n          year: year,\n          includedYears: includedYears,\n          lines: lines.slice(0, 5),\n          unit: unit,\n          profileType: profileType,\n          style: style,\n          nodeName: nodeName,\n          commodityName: commodityName,\n          columnName: columnName,\n          verb: verb,\n          testId: \"\".concat(testId, \"-chart\")\n        })), React.createElement(\"div\", {\n          className: \"column small-12 medium-5 top-destinations-map-widget\"\n        }, React.createElement(TopDestinationsMap, {\n          height: 250,\n          year: year,\n          printMode: printMode,\n          verb: verb,\n          buckets: buckets,\n          lines: lines,\n          nodeName: nodeName,\n          testId: \"\".concat(testId, \"-map\"),\n          profileType: profileType,\n          countryName: countryName,\n          includedYears: includedYears,\n          commodityName: commodityName,\n          activeTab: type === 'regions' ? activeTab : undefined\n        }))));\n      });\n    }\n  }]);\n\n  return TopDestinationsWidget;\n}(React.PureComponent);\n\nTopDestinationsWidget.propTypes = {\n  testId: PropTypes.string,\n  printMode: PropTypes.bool,\n  className: PropTypes.string,\n  countryName: PropTypes.string,\n  commodityName: PropTypes.string,\n  type: PropTypes.string.isRequired,\n  year: PropTypes.number.isRequired,\n  nodeId: PropTypes.number.isRequired,\n  contextId: PropTypes.number.isRequired,\n  onLinkClick: PropTypes.func.isRequired\n};\nvar _default = TopDestinationsWidget;\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_typeof, \"_typeof\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_objectSpread, \"_objectSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_toConsumableArray, \"_toConsumableArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_nonIterableSpread, \"_nonIterableSpread\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_iterableToArray, \"_iterableToArray\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_arrayWithoutHoles, \"_arrayWithoutHoles\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_defineProperties, \"_defineProperties\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_getPrototypeOf, \"_getPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_setPrototypeOf, \"_setPrototypeOf\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_assertThisInitialized, \"_assertThisInitialized\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_defineProperty, \"_defineProperty\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(TopDestinationsWidget, \"TopDestinationsWidget\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/rodrigo/WorkWorkWorkWorkWork/trase/frontend/scripts/react-components/profile-node/profile-node-widgets/top-destinations-widget.component.jsx"],"names":["TopDestinationsWidget","React","PureComponent","activeTabIndex","data","tabs","activeTab","linesData","includedYears","buckets","lines","style","unit","profileType","profile_type","index","printMode","year","nodeId","contextId","type","className","commodityName","countryName","onLinkClick","testId","mainQuery","params","node_id","context_id","loading","error","console","nodeName","columnName","verb","undefined","PropTypes","isRequired"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport TopDestinationsChart from 'react-components/profiles/top-destinations-chart.component';\nimport TopDestinationsMap from 'react-components/profiles/top-destinations-map.component';\nimport {\n  GET_ACTOR_TOP_COUNTRIES,\n  GET_ACTOR_TOP_SOURCES,\n  GET_NODE_SUMMARY_URL\n} from 'utils/getURLFromParams';\nimport Widget from 'react-components/widgets/widget.component';\nimport ShrinkingSpinner from 'react-components/shared/shrinking-spinner/shrinking-spinner.component';\n\nclass TopDestinationsWidget extends React.PureComponent {\n  state = {\n    activeTabIndex: this.props.printMode && this.props.contextId === 1 ? 1 : 0\n  };\n\n  getActiveTabProps(data) {\n    const { activeTabIndex } = this.state;\n\n    const tabs = [...data.tabs].reverse();\n    const activeTab = tabs[activeTabIndex];\n    const linesData = data[activeTab];\n    const { includedYears, buckets } = data;\n    const { lines, style, unit } = linesData;\n\n    return {\n      tabs,\n      unit,\n      lines,\n      style,\n      buckets,\n      activeTab,\n      includedYears,\n      profileType: linesData.profile_type\n    };\n  }\n\n  updateTab = index => this.setState({ activeTabIndex: index });\n\n  render() {\n    const {\n      printMode,\n      year,\n      nodeId,\n      contextId,\n      type,\n      className,\n      commodityName,\n      countryName,\n      onLinkClick,\n      testId\n    } = this.props;\n    const mainQuery = type === 'countries' ? GET_ACTOR_TOP_COUNTRIES : GET_ACTOR_TOP_SOURCES;\n    const params = { node_id: nodeId, context_id: contextId, year };\n    return (\n      <Widget\n        query={[mainQuery, GET_NODE_SUMMARY_URL]}\n        params={[{ ...params, year }, { ...params, profile_type: 'actor' }]}\n      >\n        {({ data, loading, error }) => {\n          if (loading) {\n            return (\n              <div className=\"spinner-section\" data-test=\"loading-section\">\n                <ShrinkingSpinner className=\"-large\" />\n              </div>\n            );\n          }\n\n          if (error) {\n            // TODO: display a proper error message to the user\n            console.error('Error loading top destinations data for profile page', error);\n            return null;\n          }\n\n          const {\n            includedYears,\n            lines,\n            unit,\n            profileType,\n            style,\n            buckets,\n            activeTab,\n            tabs\n          } = this.getActiveTabProps(data[mainQuery]);\n\n          if (!lines || lines.length === 0) {\n            return null;\n          }\n\n          const { nodeName, columnName } = data[GET_NODE_SUMMARY_URL];\n          const verb = columnName === 'EXPORTER' ? 'exported' : 'imported';\n          return (\n            <section className={className} data-test={testId}>\n              <div className=\"row align-justify\">\n                <div className=\"column small-12 medium-7\">\n                  <TopDestinationsChart\n                    height={250}\n                    type={type}\n                    tabs={tabs}\n                    onChangeTab={this.updateTab}\n                    onLinkClick={onLinkClick}\n                    contextId={contextId}\n                    year={year}\n                    includedYears={includedYears}\n                    lines={lines.slice(0, 5)}\n                    unit={unit}\n                    profileType={profileType}\n                    style={style}\n                    nodeName={nodeName}\n                    commodityName={commodityName}\n                    columnName={columnName}\n                    verb={verb}\n                    testId={`${testId}-chart`}\n                  />\n                </div>\n                <div className=\"column small-12 medium-5 top-destinations-map-widget\">\n                  <TopDestinationsMap\n                    height={250}\n                    year={year}\n                    printMode={printMode}\n                    verb={verb}\n                    buckets={buckets}\n                    lines={lines}\n                    nodeName={nodeName}\n                    testId={`${testId}-map`}\n                    profileType={profileType}\n                    countryName={countryName}\n                    includedYears={includedYears}\n                    commodityName={commodityName}\n                    activeTab={type === 'regions' ? activeTab : undefined}\n                  />\n                </div>\n              </div>\n            </section>\n          );\n        }}\n      </Widget>\n    );\n  }\n}\n\nTopDestinationsWidget.propTypes = {\n  testId: PropTypes.string,\n  printMode: PropTypes.bool,\n  className: PropTypes.string,\n  countryName: PropTypes.string,\n  commodityName: PropTypes.string,\n  type: PropTypes.string.isRequired,\n  year: PropTypes.number.isRequired,\n  nodeId: PropTypes.number.isRequired,\n  contextId: PropTypes.number.isRequired,\n  onLinkClick: PropTypes.func.isRequired\n};\n\nexport default TopDestinationsWidget;\n"]}]}